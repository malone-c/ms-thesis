% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
\PassOptionsToPackage{dvipsnames,svgnames*,x11names*}{xcolor}
%
\documentclass[
  oneside]{book}
\usepackage{amsmath,amssymb}
\usepackage{lmodern}
\usepackage{setspace}
\usepackage{ifxetex,ifluatex}
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\usepackage{xcolor}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\hypersetup{
  pdftitle={Bayesian inference of eradication of incipient Tephritid fruit fly populations, with application to Mediterranean fruit fly},
  pdfauthor={Chris Malone},
  colorlinks=true,
  linkcolor=Maroon,
  filecolor=Maroon,
  citecolor=Blue,
  urlcolor=blue,
  pdfcreator={LaTeX via pandoc}}
\urlstyle{same} % disable monospaced font for URLs
\usepackage[margin=3cm]{geometry}
\usepackage{longtable,booktabs,array}
\usepackage{calc} % for calculating minipage widths
% Correct order of tables after \paragraph or \subparagraph
\usepackage{etoolbox}
\makeatletter
\patchcmd\longtable{\par}{\if@noskipsec\mbox{}\fi\par}{}{}
\makeatother
% Allow footnotes in longtable head/foot
\IfFileExists{footnotehyper.sty}{\usepackage{footnotehyper}}{\usepackage{footnote}}
\makesavenoteenv{longtable}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{5}
\usepackage{booktabs}
\usepackage{setspace}
\usepackage{amsmath}
\usepackage[algo2e,linesnumbered,ruled]{algorithm2e}
\usepackage{algorithm}
\ifluatex
  \usepackage{selnolig}  % disable illegal ligatures
\fi
\usepackage[]{natbib}
\bibliographystyle{plainnat}

\title{Bayesian inference of eradication of incipient Tephritid fruit fly populations, with application to Mediterranean fruit fly}
\author{Chris Malone}
\date{2022-05-26}

\begin{document}
\maketitle

\setstretch{1}
% Trigger ToC creation in LaTeX
\renewcommand{\baselinestretch}{1}\normalsize
\tableofcontents
\renewcommand{\baselinestretch}{2}\normalsize

\hypertarget{introduction}{%
\chapter{Introduction}\label{introduction}}

\hypertarget{control-and-monitoring-of-tephritid-fruit-flies}{%
\section{Control and monitoring of Tephritid fruit flies}\label{control-and-monitoring-of-tephritid-fruit-flies}}

Biological (pest) invasions are incursions of incipient populations of plants or animals that are non-native to a given region.\footnote{Note that, for this work, the term \emph{population} will be used to mean a group of animals living together in a group. This is to be distinguished from the statistical use of the term.} Such invasions can have high economic significance when the invading species is considered a \emph{pest} (i.e., harmful to human concerns). Amid the ongoing globalisation of trade, the salience of biological invasions is increasing around the world. Invasions pose severe economic and environmental risks. On the economic side, they may threaten ``wholesale loss of agricultural, forestry, and fishery resources'' (\citet{mack2000}). On the environmental side, they may threaten to disrupt native ecological processes -- e.g.~by threatening the extinction of endangered natives, and creating globally homogenous, ``cosmopolitan'' ecological systems (Ibid.).

Tephritid fruit flies (\emph{Diptera Tephritidae}) are a genus of insects of particularly high economic significance. Species in this genus have the potential to destroy a wide variety of horticultural produce in large amounts. Females lay eggs in plant tissue (often fruits) which is then destroyed in the process of their development. Economic costs of successful fruit fly invasions in Australia have been estimated to be as high as hundreds of millions of dollars (\citet{suckling2016}, \citet{hancock2000}). Potential costs of Tephritid fruit fly incursions include crop losses; labour and materials associated with eradication and suppression; and knock-on effects to agricultural produce as a consequence of pesticide usage (\citet{suckling2016}).

Some locations in Australia and the USA are internationally recognised exclusion zones for some species of fruit fly. In some of these places \emph{spot infestations} of the relevant fly species can be common (\citet{meats2005}). Spot infestations are small invasions, usually met with efforts to eradicate. Eradication methods include spraying of pesticides and release of sterile insects that disrupt the flies' breeding cycle. Currently, it is widespread practice that inference of absence for such invasions is informal. In particular, pest absence is declared according to rules of thumb (Ibid.). These rules are in the form of \textbf{zero-catch criteria}. The idea is that, if zero flies are detected for some pre-specified length of time (the zero-catch criterion) we may infer with confidence, and therefore declare, that they have been eradicated from the region (see chapter 2).

There are issues with the zero-catch criteria currently used. Firstly, they are only minimally sensitive to variability between situations. For example, outbreaks in two locations with the same temperatures will have the same zero-catch criteria, even though they may differ in other significant ways. Secondly, they do not explicitly or transparently take into account the low sensitivity of fruit fly traps, which has been the subject of some study (see chapter 2). Thirdly, they are based on a simplified model of fruit fly biology which does not account for variation in development times (both within and between fly populations).

The primary goal of the present work is to develop a rigorous statistical framework for inferring pest absence after a suspected outbreak. The hope is that such a framework can be useful (a) to evaluate existing zero-catch criteria, and (b) to develop improved criteria. A secondary goal of the framework is to provide situation-specific estimates of the probability of eradication. These may be useful to the regulator, who wishes to weigh the cost of eradication probabilistically against the cost of a successful biological invasion.

The method I propose involves spatially explicit, agent-based modelling of the relevant fruit fly population. This proposal is inspired by similar recent works using Bayesian models to infer the probability of pest absence from real data (see chapter 2).

\hypertarget{outline-of-this-work}{%
\section{Outline of this work}\label{outline-of-this-work}}

I begin this work in chapter 2 by reviewing relevant literature. In particular, I discuss two bodies of literature. The first is on the existing literature on quantitative analysis of zero-catch criteria for tephritid fruit flies. I explain zero-catch criteria in greater detail, and then discuss some ways in which they have been analysed and evaluated in academic literature. The second is on existing Bayesian models for inferring the probability of pest absence. Two example cases from the literature are discussed as inspiration for the model developed in the present work. As far as I know, these are the only such models for this problem (inferring extirpation of a pest population) presented to date. In chapter 3, I develop, and justify, a framework for modelling tephritid fruit fly invasions. Model details are discussed at an abstract level. The focus of this chapter is to present a skeleton of the method. I.e., the basic structure of the model, and core quantities of interest, are discussed. But the model is not fully specified or fit to data. Finally, in chapter 4, I apply the methodology to the specific case of Mediterranean fruit fly, a tephritid species of particularly high economic significance in the USA and Australia. A joint prior distribution is defined over the parameters of the model, and inference is performed to evaluate and derive zero-catch criteria for a hypothetical case.

\hypertarget{lit-review}{%
\chapter{Literature review}\label{lit-review}}

\hypertarget{introduction-1}{%
\section{Introduction}\label{introduction-1}}

The present work responds to two bodies of literature. Firstly, it responds to the literature on zero-catch criteria for tephritid fruit flies. In particular, I propose a methodology for rigorous, model-based evaluation and revision of zero-catch criteria. Secondly, this work responds to the literature on Bayesian inference of eradication of pest populations in general. Thus far, Bayesian models of pest extirpation have been developed for at least two scenarios. However, tephritid fruit flies raise some unique challenges, which the present work discusses. Further, the question of zero-catch criteria is not broached. In this chapter, I discuss each of these bodies of literature, how they inform the present work, and the problem this work seeks to address. I begin by discussing fruit fly zero-catch criteria, and how they have been analysed in the literature. I then move on to discuss the Bayesian models that inspire the approach I take in chapters 3 and 4.

\hypertarget{zero-catch-criteria}{%
\section{Zero-catch criteria}\label{zero-catch-criteria}}

As mentioned in chapter 1, inference of pest absence is typically performed based on rules of thumb, referred to here as \emph{zero-catch criteria} (following \citet{meats2005}). In some fruit fly exclusion zones that are at high risk of invasion, a network of monitoring traps is laid out year-round. These traps are checked periodically (typically every 7-14 days). These are minimum periods of time over which a fly is not detected. If we do not detect a fly for the specified (temperature-dependent) number of weeks, then we may infer and declare that the incipient population has been eradicated.

The reader may wonder why declaring eradication is considered important. The primary reason is that pest-free area (PFA) status is economically valuable to producers in the relevant region. This is because there may be offshore markets which require that produce is supplied from a PFA for a given pest. Even without such a requirement, PFA status may allow the supplier to receive a price premium for goods sold. As such, PFA status increases the value of goods sold.

Zero-catch criteria vary according to the species and the international market for the relevant produce (\citet{meats2005}). However, it is typical that they are based on the assumed length of a generation. For example, for Mediterranean fruit fly the criterion is 12 weeks, or 4 weeks and 1 generation, whichever is longer. The length of a generation is typically a constant based on the number of ``degree days'' that pass. Briefly, the degree days associated with a sequence of days of length \(n\) is the sum of average temperatures for each day, minus the development threshold for the relevant species. Here, the development threshold is the lowest temperature at which we assume the species is capable of developing.\footnote{It may help to consider an example. Suppose over 3 days we observe minimum temperatures \(\mathrm{min}_1 = 6, \mathrm{min}_2 = 8,\) and \(\mathrm{min}_3 = 7\), and maximums \(\mathrm{max}_1 = 22\), \(\mathrm{max}_2 = 18\), \(\mathrm{max}_3 = 19\). Assume flies don't develop when the ambient temperature is below \(10^\circ \mathrm{C}\). Then the accumulated number of degree days in this period is \(\sum_{i=1}^3 \left(\frac{\mathrm{min}_i + \mathrm{max}_i}{2} - 10\right) = 10\).} Degree day methods are simple but ignore important aspects of fly biology such as humidity, host availability, and differential effects of temperature on different life stages of fly -- e.g.~larvae, adult, etc. (\citet{collier2017}). Importantly, they are considered to be relatively arbitrary (see \citet{meats2005} and \citet{collier2017}).

As is hopefully clear from the discussion so far, zero-catch criteria are relatively informal. They assume, implicitly, that, if we have not detected a population in a certain fixed number of generations, then they must not be present at a sustainable population density. \citet{meats2005} provide point estimates of the probability that the zero-catch criteria ``get it wrong'' by recommending reinstatement of PFA status when flies are still present at a sustainable level. However, crucial to the authors' analysis is the assumption that the zero-catch criteria are generally correct. In particular, they assume that the implied acceptable rate of fly detection (under the rule of thumb) corresponds to the lowest viable population density for the fly species in question. The justification given is that the criteria are formulated based on a significant degree of practical experience. However, it is debatable whether it is possible to learn optimal zero-catch criteria by experience. In particular, in the case of Mediterranean fruit fly, there is a long-standing debate about whether spot infestations in California are due to repeated eradications, or instead due to repeated flare-ups of one continuous low-lying population (\citet{carey2017}). As such, it is unclear whether existing zero-catch criteria should be taken at face value, as these authors do. Further, it is not possible to evaluate criteria using the authors' method as it is based on the assumption that the zero-catch criteria are correct.

Some attempts have been made to evaluate zero-catch criteria using agent-based models (see, e.g. \citet{collier2017}). For this work, I will say that a model is agent-based when properties of individual agents (here, biological individuals) are explicitly represented. For example, we may be concerned with locations or reproduction rates, which we presume to differ between individuals. As such, the definition of an agent-based model is not mathematical, but scientific, as it pertains to the interpretations of mathematical objects. Such studies as that mentioned above involve simulating the time to extirpation of outbreaks in various locations. The idea is to determine the time taken for the pest population to be eradicated under control measures. However, this method does not use information in survey records to inform this process.

\hypertarget{bayesian-models-for-inferring-the-presence-or-absence-of-a-pest-population}{%
\section{Bayesian models for inferring the presence or absence of a pest population}\label{bayesian-models-for-inferring-the-presence-or-absence-of-a-pest-population}}

The problem of inferring the presence or absence of a difficult-to-detect species has a literature of its own. Models date back to at least the 1990s, using relatively simple and general models to infer pest absence (see \citet{boakes2015} and \citet{caley2014} for reviews). Such methods are attractive for their simplicity, generality, and efficiency of computation. Unfortunately, these models make strong assumptions about prior distributions for key model parameters which are not defensible in general. For example, most assume a fixed, and either constant or declining population size (\citet{caley2015}, p.~2). This is not reasonable for the study of invasive species, for which the population growth rates are uncertain, and indeed may be increasing.

Another issue with simpler models is their relative inflexibility with respect to the structure of the model. For example, many models (see, e.g., \citet{mcardle1990}, \citet{barnes2021}, \citet{boakes2015}) assume that we know the probability of detecting a specimen drawn randomly from the population. However, in the case of fruit flies, this quantity is difficult to study empirically. This is because the capture probability is dependent on the spatial layout and types of monitoring traps that are deployed. Spatial density and trap type vary between situations. For example, countries (and states within countries) differ in the types of traps used and the spatial density of traps. As such, while we may be able to learn about the probability of capture \textbf{per trap}, it is not possible to learn about the probability that a fly is captured in general.

In contrast, a class of elaborate models for inferring species extinction have recently appeared in the literature on inferring pest extirpation from survey records. In particular, two attempts have recently been made to develop biologically realistic models to infer the probability of eradication from the survey record. These papers inspire the model I develop in the following chapter -- although there are also some marked differences, as the reader will see. Here, I will discuss the contributions of each of these papers.

\hypertarget{red-fire-ants}{%
\subsection{Red fire ants}\label{red-fire-ants}}

The first instance of a Bayesian model for inferring presence or absence of a pest is given by \citet{keith2013}. The authors use an agent-based Bayesian model to infer the distribution of fire ant nests in Brisbane. They obtained data on the locations and month of discovery for \(n = 7{,}068\) nests. They also observed whether data were passively or actively discovered (e.g.~by members of the public or through a targeted search).

A core aim of this model is to infer the size and spatial distribution of a super-population of ants. Under the prior distribution, the ant super-population spreads through the founding of new colonies (sub-populations). In particular, once each nest matures (after 8 months) it founds a new ant nest with some unknown probability. The authors refer to this founding event as a ``jump''. Time series data of discoveries is used to infer parameters such as the number of ant nests, the distribution of ``jump'' distances, and the probability of founding a new nest. The joint posterior distribution of these parameters is then used to infer the spatial distribution of ant nests across several years.

The model explicitly models the location of each agent (ant nest). As such, the number of parameters in the model is itself unknown. The upshot of this is that typical Markov chain Monte Carlo (MCMC) methods, such as standard Metropolis-Hastings sampling, fail. This is because they do not allow the dimension of the parameter vector to vary between draws. As discussed in chapter 4, this is a general problem faced by agent-based Bayesian models. To get around this problem, the authors use a generalisation of reversible jump Markov sampling (\citet{green1995}) known as generalised Gibbs sampling. This gets around the problem by adding a step to the Gibbs sampler in which the Markov chain moves between coordinate spaces.

\hypertarget{red-foxes}{%
\subsection{Red foxes}\label{red-foxes}}

The second instance of a Bayesian model for inferring eradication is given by \citet{caley2015}. Caley and co-authors develop a Bayesian model of fox sightings in Tasmania. Their goal is to infer the posterior probability that foxes had been eradicated, given a record of fox carcass sightings. They obtained data on fox carcass sightings from two sources, namely, hunter kills and road kills. These separate ``observation processes'' were modelled separately, so that posterior detection rates were allowed to differ between the sighting types. Detection rates were assumed to be constant across time and location for each type of sighting. Notably, uninformative prior distributions were set for detection rates (i.e.~the probability of detecting a fox was set to be uniform on \([0, 1]\)). This was because the fox sighting mechanism has not been studied empirically (indeed, it is not clear how it could be studied at all). Data consisted of a single sighting count for each location (with Tasmania divided geographically into grid cells) and each year between 2001 and 2013. Data were all zeroes except for exactly four unit observations (sightings of exactly one fox).

The authors use a form of approximate Bayesian computation (ABC) to sample from the posterior. In the simplest case, ABC works by first drawing samples of the parameter vector \(\theta\) from the prior distribution \(\pi(\theta)\), then second, drawing simulated data \(y_{\text{sim}}\) from the likelihood, then keeping the proposed \(\theta\) if and only if \(y_{\text{sim}}\) is an approximate match with the observed data. The authors use the sum of the observations over the observation period as the matching statistic. They kept samples only if the \(y\) simulations were an exact match with the data. The justification given for using this method is that the likelihood is not analytically tractable.

\hypertarget{gaps}{%
\section{Gaps}\label{gaps}}

Above, I have discussed the two models in the literature for inferring the eradication of an incipient biological invasion. The current work seeks to address two gaps in the literature.

Firstly, Bayesian models have not been explored for inferring eradication of Tephritid fruit flies. Fruit flies pose an interesting case study because the regulator has fine-grained information about the detection system. In particular, the surveillance system is relatively simple. Traps are placed at fixed, known locations, and checked periodically, at regular time intervals. Further, prior research investigating the efficacy (i.e.~sensitivity) of these traps exists (see chapter 3). If used carefully, this information can be leveraged through the model's prior distributions to learn from the zero-sighting record efficiently. Since the authors discussed above used noninformative prior distributions for key parameters, leveraging such information represents the first attempt to use prior literature to set informative prior distributions for such a model.

Complex models have not been developed to study the problem of inferring fruit fly eradication from zero-sighting records. Such models, if developed, could perform a range of useful functions. For example, when used with zero-catch data, such models could be used (a) to evaluate rules of thumb for PFA reinstatement; (b) to rigorously devise new recommendations for PFA reinstatement, that are sensitive to specific features of the outbreak; and (c) to provide the decision-maker with precise probabilistic estimates of the probability of eradication given any particular length of time for which flies were not detected. Further, such models, when used with real surveillance datasets, could also be used to learn about crucial properties of fruit fly species, such as their field population growth rates, and trap capture rates.

The present work builds on the work of \citet{lance1994}. In that work, the authors first estimate the probability of detection in a single trap, as a function of the distance between trap and fly, based on their own experimental data. Then, they use the estimated curve to derive a point estimate of the probability of capturing one or more flies. This is done under the assumption of a uniform prior distribution for the locations of flies. Under these assumptions, the authors examine the likelihood of zero detections for various population sizes. This allows the authors to estimate how large the population needs to be before it is detected with a high degree of certainty. This work generalised that work in two ways. Firstly, a prior distribution is defined for the population size. This allows us to infer the posterior probability of eradication. Secondly, a more realistic prior is set for fly locations. In real cases, if we suspect the presence of a fly population, we will typically have some information about its whereabouts. I discuss ways for using this information to infer the probability of eradication more efficiently in chapter 3.

\hypertarget{conclusion}{%
\section{Conclusion}\label{conclusion}}

The purpose of this chapter has been to situate the current work with respect to two bodies of literature. On one hand, there is the literature on tephritid fruit flies. While computational models of population dynamics exist, there has been no comprehensive attempt to use statistical modelling to evaluate or propose zero-catch criteria. On the other hand, there is the literature on Bayesian models for inferring eradication of pests. Here, there has not been a model proposed for the case where there exists information on the probability of detection as a function of distance between surveyor and individual. The present work seeks to solve both of these problems simultaneously. I.e. a novel Bayesian model of medfly detections is developed, and applied to the problem of evaluating and proposing zero-catch criteria. In the next chapter. I turn to discuss the model in broad generality. Then, in chapter 4, I apply the model developed in chapter 3 to a case study.

\hypertarget{ch3}{%
\chapter{General framework proposal}\label{ch3}}

\hypertarget{introduction-2}{%
\section{Introduction}\label{introduction-2}}

In this chapter, I describe a general probabilistic model of an ecological system. The size, location, and number of captures, for a biological population, are explicitly modelled. The model is agent-based, as the properties of individual flies (namely their locations) are explicitly represented as latent (i.e.~unobservable) variables. It is assumed that the data given are a number of captures (or, alternatively, sightings or detections), and that we wish to infer posterior distributions for the parameters governing size and/or locations. The structure of the model is explained, along with core parameters. Specific prior distributions are not set here, as prior distributions should depend on the species of fly under consideration. In chapter 4, a case study is performed, where the prior distributions and likelihood are specified more precisely.

\hypertarget{why-make-the-model-spatially-explicit}{%
\section{Why make the model spatially explicit?}\label{why-make-the-model-spatially-explicit}}

The value of including a spatial component in the model may be questioned. This is relatively unusual in standard approaches (see, e.g., \citet{mcardle1990}). It is typical, instead, to assume that each fly has identical probability of being detected (captured). However, incorporating the spatial component allows us to leverage a useful source of prior information about trap efficacy. There exists a moderately large literature of \textbf{release-recapture} studies for various species of fruit fly (see \citet{andress2013} for a review). Release recapture studies give us two kinds of data -- on one hand, we get the total proportion of flies recaptured; on the other hand, we also get the mean proportion of flies captured \textbf{per trap}, given distance between that trap and the release point. The first kind of data can be useful when the experimental setting is similar to the real-world setting for which we want to perform inference. This will be approximately the case when the types of traps, their number, and the spacing between them, are the same. However, this will often not be the case. In particular, studies vary significantly in the types and number of traps used. For example, \citet{lance1994} used Jackson traps spaced 1.6 km apart, as is standard in California. Meanwhile, \citet{ms2007} used Lynfield traps, spaced 0.4 km apart, as is standard in Adelaide. Further, we may wish to infer eradication of pest populations in trapping systems that are genuinely novel or untested. For example, after an outbreak has occurred, and eradication measures have been stopped, it is common to set up supplementary trapping units to intensify monitoring and increase the likelihood of detecting flies, conditional on their presence in the area (\citet{supptraps}).

\hypertarget{structure-of-the-model}{%
\section{Structure of the model}\label{structure-of-the-model}}

At the most basic level, I propose to define a joint distribution over (a) the number of flies in a population, (b) the location of each fly, and (c) whether or not any flies were detected (i.e.~caught in traps). Defining notation, at each time point \(t\), we must define a joint distribution over (a) the number of flies \(N_t\), (b) the \(N_t \times 2\) matrix of fly locations \(\mathbf L_t\), and (c) an indicator variable \(y_t\) which is 1 if any fly was caught at time \(t\).\footnote{It is assumed that the frequency of time points \(t\) corresponds to the frequency at which surveillance traps are checked.} I.e., the model is in essence a joint distribution \(p(\{N_t, \mathbf L_t, y_t\}_{t=1}^T)\). Recall that our goal is to evaluate zero-catch criteria for declaring eradication. Therefore, to evaluate zero-catch criteria, we want to infer \(\Pr(N_T = 0 \mid \mathbf \{y_t\}_{t=1}^T = \mathbf 0_T)\), where \(T\) is the established zero-catch criteria, based on degree day calculations. Call this quantity \textbf{the probability of eradication conditional on no detection}. To derive new zero-catch criteria, we want to find the smallest \(T\) such that \(\Pr(N_T = 0 \mid \{y_t\}_{t=1}^T = \mathbf 0_T) < 1-\alpha\), for some threshold \(\alpha\). Here, \(\alpha\) represents our risk tolerance. Call this quantity \textbf{the time to eradication}.

A Bayesian framework is assumed for inference. As such, to infer the above quantities, we must specify a joint \textbf{prior} distribution over \(\{N_t, \mathbf L_t\}\), and a likelihood, i.e.~a distribution for \(\mathbf y \mid \{N_t, \mathbf L_t\}_{t=1}^T\). Instead of defining a joint prior directly on \(\mathbf N = \{N_t\}_{t=1}^T\), I define a prior distribution over the parameters that govern the process by which the population grows or decays over time. As such, an assumed stochastic growth model structures the prior over \(\mathbf N\).

\hypertarget{population-size}{%
\subsection{Population size}\label{population-size}}

As mentioned above, a prior distribution must be set for the population size \(N_t\) at each time point \(t \in \{1, \ldots, T\}\). A natural way to do this is to define a stochastic model of the population's change. Explicitly, I recommend to define a prior over \(N_1\) directly. Then, for each \(t \in \{1,2, \ldots, T\}\), define a prior on \(N_t\), conditional on the previous values \(\{N_i\}_{i=1}^{t-1}\), as well as parameters governing the growth. A simple example, which I employ in chapter 4, is the Poisson branching process with exponential growth or decay. This is a model of the form
\[
N_t \mid \{N_{t-1}, R_t\} \sim \operatorname{Poisson}(N_{t-1} \exp \{R_t\}),
\]
where a continuous prior distribution is defined over the \(R_t\) terms, which may have support over the whole real line.\footnote{Alternatively, the logistic growth model, with an additional ``carrying capacity'' parameter, could be used.} This model has the attractive property that, when we condition on \(\{R_t\}_{t=1}^T\) but marginalise out \(\{N_t\}_{t=1}^{T-1}\), \(N_T\) has mean \(\mathrm E(N_1) \exp \left\{ \sum_{t=1}^T R_t \right\}\).\footnote{Note, however that \(N_T \mid \{R_t\}_{t=1}^T\) is not Poisson distributed, and has variance strictly larger than its mean.} This is attractive because the exponential growth model is popular in biology and ecology. Given this, in many cases, it should be relatively simple to set informative prior hyperparameters for the latent variable \(R_t\). We might do this through expert elicitation, or through review of the relevant literature, in which population change may already be expressed in terms of growth rates.\footnote{For example, see \citet{papadopoulos2002}.}

It may be worth noting that we could choose to factor in covariate information for the growth process. For example, for a given pest species, we might understand the growth of populations over time as a function of weather or rainfall.

It may also be worth noting that there are no a priori assumptions on the population dynamics for the growth model. In principle, it should be simple to ``plug in'' elaborate growth models. For example, the models of \citet{lux2018} or \citet{manoukis2014} could be used to generate independent random draws from the population of Medfly. In this way, they can structure our prior over the population size. In this case, inference would proceed simply as in the case I outline here. This is outside the scope of this thesis, and I do not explore it further. However, this highlights key benefits of the modelling approach taken here, namely its flexibility and modularity.

\hypertarget{fly-locations}{%
\subsection{Fly locations}\label{fly-locations}}

As mentioned previously, I propose to explicitly model the location of each fly. As a consequence, at each time \(t\), a prior distribution must be set on each of the \(N_t\) flies. Accounting for prior beliefs about the location of each fly introduces substantial complexity to the model. However, this can be simplified significantly, as I hope to demonstrate here.

Note that, in typical situations, we will not be interested in inferring the posterior distributions of fly locations. As such, this is a nuisance parameter.

I first discuss the option of setting an uninformative prior. Setting an uninformative prior is fairly straightforward for this problem. In particular, we might assume that, beyond a certain distance from the outbreak centre (say, 1 km) any existing population of Medfly is distinct from the population of interest. Therefore, we might set the prior distribution for the population location to be uniform on the surface of a disc with (e.g.) 1 km radius around the outbreak centre.

Although an uninformative prior is relatively straightforward to set, it is most likely not advisable in specific applications. Firstly, when an outbreak is suspected, it is typical that information about location is available. On one hand, fruit flies are heavily dependent on the availability of suitable fruit trees for survival and reproduction. Therefore, someone with local area knowledge will be able to determine the most likely locations for an existing population. On the other hand, if an outbreak is known or suspected, then flies must have been detected somewhere. Most likely, the locations of these detections will be known to the analyst. When the fly species has low dispersal distances (as e.g.~medfly does) these detection locations are highly informative. Therefore, an informative prior, utilising this information, formally or informally, is recommended.

It is assumed the flies are typically clustered in space. This may be justifiable in practice. For a small, seed population, a population with low density will die out due to the Allee effect.\footnote{In biology and ecology, the Allee effect is the effect of population density on individual fitness. For example, when the population density is low, it may become more difficult to find a viable mate, and individuals may have greater exposure to risk of predation. See \citet{stephens1999}.} However, when this assumption is not realistic, an alternative prior distribution on locations should be considered.

Let \(L_c\) be a bivariate random variable describing the centre of the population. Let \(L_{i, t}\) be a bivariate random variable describing the location of fly \(i\) at time \(t\). It seems natural to assume that \(\mathrm E (L_{i, t} \mid L_c) = L_c\), for any \((i, t)\). This model assumes that the centre of the population does not move over time. Further, we can specify that \((L_{i, t} \perp \!\!\! \perp L_{i', t'}) \mid L_c\), for \((i, t) \neq (i', t')\). I.e., conditional on the centre of the population, the fly locations provide no information about each other. This gives the computational advantage that we do not need to track flies locations across time. At each time period, they scatter independently.

The benefit of these assumptions is that prior distributions can be set on the parameters governing \(L_c\) and \(L_{i, t} \mid L_c\) separately. The prior distribution on \(L_{i, t}\) describes the distribution of fly dispersals. Information on this quantity, for a given species, will often be available in scientific literature.

\hypertarget{probability-of-capture-likelihood}{%
\subsection{Probability of capture (likelihood)}\label{probability-of-capture-likelihood}}

Recall from above that the number of captures (and therefore the data for this model) at time point \(t\) is written as \(y_t\), for \(t \in \{1, \ldots, T\}\). Recall that we assume that the trap locations are each fixed and known with certainty. Further, we denote the probability that fly \(i\) is caught in trap \(k\) at time \(t\) is \(p(c \mid d_{i, k, t})\) where \(d_{i,k,t}\) is the distance between fly \(i\) and trap \(k\) at time \(t\). Then, the probability that fly \(i\) is caught at any trap is simply
\[
p_{i, t} := 1 - \prod_{k=1}^K(1 - p(c \mid d_{i, k, t})).
\]
I.e., it is the probability that the fly is caught in at least one trap.

Going further, the probability that any fly (out of \(N_t\) flies) is caught at any trap is
\[
p_t := 1 - \prod_{t=1}^{N_t} (1 - p_{i,t}).
\]
Therefore, conditional on \(\mathbf L_t\) and \(N_t\), we can define
\[
y_t = \begin{cases} 1 & \text{one or more flies caught at time} ~t \\ 0 & \text{otherwise.} \end{cases}
\]
For each time point \(t\), \(y_t\) has the Bernoulli distribution with mean \(p_t\).

The probability of capture function, given distance (namely \(p(c \mid d)\)) should be based on prior analysis of release-recapture data, already discussed, and may be either deterministic or random. For example, we might regress captures on distance, from release-recapture data, and allow coefficients to vary randomly. Then, the posteriors would form the prior distributions for the present model.

A few things should be noted here. Firstly, \(y_t\) is not the number of captures per se, but rather is binary as defined above. This simplification can be made because we are only interested in the case where no flies are detected. This is because the primary application of the model is to evaluate and derive zero-catch criteria. To extend the model to the case where we observe non-zero captures, we can simply define \(y_t\) to be the sum of Bernoulli trials for \(i \in \{1, \ldots, N_t\}\), each with mean \(p_{i,t}\).

Secondly, this model of captures takes for granted the common assumption that there is no interference between traps. This assumption is essentially that the probability that a fly is captured at a given trap is not affected by the presence of other traps. In some cases, this may cause us to overestimate the probability that a fly will be captured at a trap. Adding an extra trap slightly lowers the probability a fly will be captured in any other traps. This is because capture is an ``absorbing state'' for flies -- they cannot be captured anywhere else after they have been captured once.

This is not likely to be a significant issue in practice. The reason for this is that \(p(c \mid d)\) is typically estimated to decrease quickly as a function of distance. This is because traps are generally ineffective as attractants. Therefore, given a single fly location, it is typical that \(p(c \mid d_{i, k, t})\) is very small for all but at most one trap. In other words, given any location for a single fly, there will typically be at most one trap such that this fly is close enough to have a significant probability of being captured in that trap. Therefore, the effect of trap interference can be discounted. High-distance traps have capture probability too low to significantly affect capture probability for low-distance traps. And low-distance do not affect high-distance traps, because the probability of capture is already extremely close to zero for the latter.

Thirdly, the reader should note that it is assumed that this is homogenous across time. I.e., the population size \(N_t\) and locations of flies \(\mathbf L_t\) tell us everything we can know about whether a fly is captured at time \(t\). As such, it is assumed implicitly that temperature does not directly affect fly behaviour. This is a strong assumption, against which there is some evidence (see \citet{bali2021}).

Finally, a key limitation of the method proposed here is that, in general, it will not give prior and posterior densities for the probability of eradication. In general, it would be desirable to quantify uncertainty about the result. In future work, reparameterisations of the model should be investigated to allow for such an extension.

\hypertarget{posterior-inference}{%
\section{Posterior inference}\label{posterior-inference}}

The statistical problem at hand is to infer the probability of eradication, given that no flies have been detected. In the notation defined above, this is \(\Pr(N_T = 0 \mid \mathbf y = \mathbf 0_T)\), where \(T\) is some threshold. When \(T\) is the zero-catch criteria, this gives us the posterior probability that the zero-catch criteria declares eradications \emph{too early} (i.e.~before the suspected pest population has been successfully eradicated). As such, the core statistical problem is to infer the posterior distribution of \(N_T\).

The above model can also be used to propose new zero-catch criteria. For example, the decision-maker might set a risk-appetite \(\alpha\) close to zero, such that a zero-catch criterion is considered reasonable if it ensures a posterior probability of eradication of at least \(1-\alpha\). Then, we simply need to find the smallest \(T\) such that \(\Pr(N_T = 0 \mid \mathbf y = \mathbf 0_T) \geq 1-\alpha\). This provides a transparent, and rigorously defined, model-based rule of thumb for declaring eradication.

\hypertarget{conclusion-1}{%
\section{Conclusion}\label{conclusion-1}}

In this chapter, I have laid out a basic framework for model-based evaluation and proposal of zero-catch criteria. This provides a general-purpose statistical methodology to support tephritid fruit fly outbreak monitoring. Notably, however, the prior distributions and the likelihood were not specified precisely. In the next chapter, a case study is performed to illustrate the use of the model for a simulated case.

\hypertarget{case-study-mediterranean-fruit-fly}{%
\chapter{Case study: Mediterranean fruit fly}\label{case-study-mediterranean-fruit-fly}}

\hypertarget{introduction-3}{%
\section{Introduction}\label{introduction-3}}

In the previous chapter, I proposed a model for evaluating and proposing zero-catch criteria in specific situations, for various locations, seasons, and species of fruit fly. In this chapter, I illustrate the method by applying the model to a hypothetical outbreak. Mediterranean fruit fly is chosen for its economic significance, and Adelaide is chosen because of the availability of research on trapping sensitivity performed there. The analysis is primarily illustrative. As before, modelling is performed with a view to evaluating existing zero-catch criteria, and toward developing new criteria. The headline result of the model is that, under the model, using the existing zero-catch criteria leads to a high risk of declaring eradication ``too early'', i.e.~while the presence or absence of flies is still highly uncertain.

\hypertarget{medfly-ceratitis-capitata}{%
\section{Medfly (Ceratitis capitata)}\label{medfly-ceratitis-capitata}}

Mediterranean fruit fly (\emph{Ceratitis Capitata}) or \emph{Medfly} are a particularly salient species of tephritid fruit fly. Medfly has high invasive potential, as it can adapt to a relatively large range of climates and environments, and is known to have the capability to infest the fruits of over 300 species of plants (\citet{sciarretta2018}). Recently, an incursion of Medfly in Adelaide, South Australia, prompted a large scale eradication effort. This comprised in part of hiring 350 special-purpose staff that set over 13,000 additional traps and collected over 350 tonnes of fruit. The scale of the response to this outbreak indicates the perceived economic significance of this species.

Medfly are very hard to detect at low levels. As with other fruit fly species, monitoring is typically performed with the aid of traps fitted with chemical attractants. These traps are relatively ineffective. For example, one study from the Adelaide metro area trapping grid found that only 0.02\% of flies were recaptured from a release of 38.8 million sterilised flies. If this is an accurate reflection of trap sensitivity, then very large populations may be undetectable for significant periods of time. Further, Medfly are known to disperse only small distances (\citet{ms2007}). This means that, if they are in a location that is not heavily monitored, they may evade detection for long periods.

\hypertarget{data}{%
\section{Data}\label{data}}

As mentioned above, I do not use real data to estimate parameters. Instead, I model a hypothetical situation. The situation is intended to simulate the conditions described in codes of practice for use of zero-catch criteria (see \citet{supptraps}). The general situation is as follows: We assume that at least one fly has been detected; eradication measures have since begun and then ceased; and we now proceed with intensified monitoring, while whatever population that may exist is free to grow relatively unhindered. The goal of the analysis is to infer the probability of eradication for the incipient population, given that no flies are detected at any point in this period.

It is preferable to specify a location, so that real weather data can be used to inform the model's hyperparameters (see section \ref{popn-size}). Therefore, it is assumed that the outbreak takes place in Adelaide. Adelaide is a key location for fruit fly outbreaks. Further, for Medfly, evidence from trap sensitivity studies is available from experiments performed in Adelaide, but no other Australian city.

The zero-catch criterion is 12 weeks, or 28 days and one generation, whichever is longer (\citet{meats2005}). In a typical Australian summer, a Medfly generation takes 28-34 days (\citet{dpirdwa}). Therefore, the period I look at is over 12 weeks.\footnote{See also \citet{pirsa}, who state that the suspension period is 12 weeks in an Adelaide summer.} I.e., in the terminology of chapter 3, we set \(T = 12\). To evaluate this criteria, we want to find the probability of eradication after \(T=12\) weeks, i.e.~\(\Pr(N_{12} = 0 \mid \mathbf y = \mathbf 0_{12})\).

It is assumed that general surveillance traps are spaced in a \(400 \times 400\) metre grid, year-round. We assume that a fly is caught at the centre of the grid (without loss of generality). Then, 16 \emph{supplementary} traps are placed within a 200-metre radius of the location of the first detection (see figure \ref{fig:trapgrid}). These traps are checked weekly for 6 weeks (\(t \in \{1, \ldots, 6\}\)) before being removed. Following this, we continue to monitor with only the original general surveillance traps. It is assumed that no fly is caught at any point in this period. Pest free area status is reinstated after 12 weeks. After this, we continue to observe no fruit flies indefinitely.

As mentioned previously, it is assumed that trap locations have fixed, known locations. In particular, we assume that monitoring is intensified for the first 6 weeks (\(t \in \{1, \ldots, 6\}\)). By intensified monitoring, I mean that \textbf{supplementary} monitoring traps have been placed alongside the previously existing grid of \textbf{general} monitoring traps. More precisely, it is assumed that \textbf{general} surveillance traps are placed year-round in a 400 \(\times\) 400 metre grid (DPIPWE, 2011, p.~50). The \textbf{supplementary} surveillance system consists of a set of 16 traps in a circular area, centred at the site of the first fly detection.\footnote{It is typical to wait until at least 2 flies have been detected near each other for an outbreak to be declared. To illustrate the method in a simplified setting, I suppose that one fly detection is sufficient.} See figure \ref{fig:trapgrid}.

It is assumed that the outbreak starts on November 1, 2020. The year 2020 is chosen rather than 2021, so that weather data is available for at least 1 year from the start of the monitoring period. (The time of writing is May 2022.) Data on historical daily temperature averages (the mean for each day) were obtained from the Bureau of Meteorology.

\begin{figure}
\centering
\includegraphics{_main_files/figure-latex/trapgrid-1.pdf}
\caption{\label{fig:trapgrid}Illustration of the hypothetical trapping grid. Grey circle represents 200m radius disc surrounding the site of the most recently detected Medfly specimen.}
\end{figure}

\hypertarget{model}{%
\section{Model}\label{model}}

I now propose a model for the case discussed above. This discussion builds on chapter 3, where I outlined the model in broad generality. There, I discussed the model while leaving some key situation-specific hyperparameters and distributions unspecified. For example, the prior distribution on the initial population size \(N_1\), and the relationship between probability of capture given distance between fly and trap \(p(c \mid d)\) were unspecified.\footnote{In that chapter, distance was denoted as \(d_{i,t,k}\), to stress that distance was measured between a given fly \(i\) and a given trap \(k\) in a given week \(t\). Here, I denote distance \(d\), under the assumption that distance is still understood to be between a fly and a trap.} Here, these gaps are filled. Hyperparameters and distributions are proposed and justified.

As in the previous chapter, the model is broken into prior distributions and likelihood in the following way. Firstly, (1) The size of the population (number of individuals); (2) the locations of individuals and traps; and (3) the number of individuals caught in traps, conditional on (1) and (2). To structure the discussion, I discuss these elements in turn, beginning with prior distributions.

Here, we are modelling the risk of an adverse event (namely an undetected pest invasion). In such cases, we might consider examining a worst-case scenario. In this case, this could be done by specifying prior distributions such that we assign high density to cases where (a) the growth rate is very close to zero, so that the fly population is capable of persisting at below-detectable levels indefinitely, or (b) flies are located far away from surveillance traps. Given these considerations, it should be trivial to identify worst-case scenarios where we can almost never be certain that flies are eradicated, given any length of time. However, such results are likely unreasonable, and do not accurately reflect our prior state of information. Nonetheless, I attempt to err on the side of pessimism about the ease at which fly populations can be detected, while nonetheless making the prior distribution as realistic as possible, given constraints on what is known about them.

\hypertarget{prior-distributions}{%
\subsection{Prior distributions}\label{prior-distributions}}

\hypertarget{popn-size}{%
\subsubsection{\texorpdfstring{Population size \(N_t\)}{Population size N\_t}}\label{popn-size}}

In this case, \(N_1\) is the first week after the most recent fly detection. I have chosen to set \(N_1 \sim \operatorname{Geometric}(1/20)\). This is chosen as it is a discrete distribution with right skew, and a relatively large amount of mass in the region of \(x = 0\), corresponding to the situation where flies are already eradicated (see figure \ref{fig:priorinitsize}).\footnote{The geometric distribution is also a natural choice for this latent variable; I do not explore this further here.} The mean of the geometric distribution is chosen arbitrarily. The primary goal is to have a small population on average, with non-zero risk of a population size greater than 50. However, it is not clear, without prior domain knowledge, whether this distribution is empirically reasonable. Population counts do not exist for past outbreaks. This issue is discussed further in section \ref{discussion}.

\begin{figure}
\centering
\includegraphics{_main_files/figure-latex/priorinitsize-1.pdf}
\caption{\label{fig:priorinitsize}Prior distribution of initial population size \(N_1\).}
\end{figure}

As for \(N_t\), for \(t \in \{2, \ldots, T\}\), I assume the Poisson branching process with exponential growth, discussed in chapter 3. To recap, it is assumed that, for \(t \in \{2, \ldots, T\}\), \(N_t \mid \{ N_{t-1}, R_t \} \sim \mathrm{Poisson}(N_{t-1} e^{R_t})\).

It is assumed, primarily for convenience, that \(R_t \sim \mathrm N(\mu_t, \sigma^2_t)\). Choices for the hyperparameters \(\{\mu_t\}_{t=2}^T\) are informed by the results of \citet{ks2019}. The authors transform observed captures \(C_t\) as \(\ln (C_t / C_{t-1})\), and fit a simple model to the resulting values from field data on Medfly captures.\footnote{Notably, temporal autocorrelation is ignored.} In particular, they estimate the mean \emph{daily} growth rate, conditional on mean daily temperature, for each day \(t\), to be
\[
\mathrm E(R_t \mid \mathrm{Temp}_t) = \alpha \mathrm{Temp}_t^2 + \beta \mathrm{Temp}_t + \gamma,
\]
where \(\alpha = -0.000386\), \(\beta = 0.0279\), and \(\gamma = -0.374\). To get the daily mean growth rates, observed daily temperatures are plugged into this formula. Then, weekly mean growth rates \(\mu_t\), are derived by summing over daily growth rates within each week. The dataset used by \citet{ks2019} is small, consisting of only 24 observations. Ideally, we would quantify uncertainty about these estimates. However, this is difficult, as the authors do not provide data or an analysis of the variance of residuals for their model. I do not explore this further here, though it should be considered in real applications.

The choice for \(\sigma^2_t\) is necessarily more arbitrary than the choice for \(\mu_t\). As mentioned above, \citet{ks2019} do not provide an analysis of the variance of residuals for their model. Therefore, it is difficult to meaningfully quantify prior beliefs about the variance of the growth rate. Increasing the variance increases the prior probability that populations die out, due to runs of ``bad luck''. Therefore, smaller variances are more pessimistic. With this in mind, I have chosen to set the standard deviation for daily growth to \(\sigma_t = \sigma = 0.1\). In my view, this is roughly consistent with the plot provided by the authors (see figure \ref{fig:ksplot}). However, as this choice is arbitrary, it should be treated with scepticism.



\begin{figure}

{\centering \includegraphics[width=0.75\linewidth]{references/ksplot} 

}

\caption{Relationship between population increase \(\ln (C_t / C_{t-1})\) and mean daily temperature. Taken from \citet{ks2019}. The solid line is fit to field data (black points); the dashed line is fit to lab data (white points).}\label{fig:ksplot}
\end{figure}

\hypertarget{spatial-location}{%
\subsubsection{Spatial location}\label{spatial-location}}

As mentioned in the previous chapter, the model is spatial. This is because the likelihood of detection depends on distances between traps and individual flies. As in the previous chapter, prior distributions must be set for the location of the population centre, and for dispersals of individual flies from that centre.

\hypertarget{population-location}{%
\paragraph{Population location}\label{population-location}}

The centre of the population is assumed to be located at the two-dimensional vector \(L_c\). I have set the prior on \(L_c\) to be
\[
L_c \sim \mathrm {Normal}_2 (\mathbf 0_2, 160^2 I_2),
\]
where \(\mathrm{Normal}_2\) is the bivariate normal distribution, \(\mathbf 0_2\) is the two-dimensional zero vector and \(I_2\) is the \(2 \times 2\) identity matrix. This prior reflects a prior belief that the centre of the population is highly likely to be close to the centre of the grid, where a fly was detected most recently (we suppose). E.g., we believe that there is a 95\% chance that the centre of the population is within \(1.96 \cdot 160 \approx 320\) metres of the centre of the grid.\footnote{For details about how this prior was arrived at, see appendix.} This makes sense, as the setting of supplementary traps close to the centre, as is standard, belies a prior belief that other flies are likely to be located in the vicinity of the first capture.

\hypertarget{individual-fly-dispersals}{%
\paragraph{Individual fly dispersals}\label{individual-fly-dispersals}}

Let \(L_{i, t}\) denote the location of fly \(i\) at time \(t\), as in the previous chapter. I assign this quantity the prior distribution \[L_{i, t} \mid L_c \sim \mathrm {Normal}_2 (L_c, 12.5^2 I_2),\] where the notation is defined as in the previous section above. The variance is chosen so that \textasciitilde95\% of flies are within 30 metres of the population centre. Here, 30 metres is chosen arbitrarily. It reflects a belief that flies typically do not disperse very far. This is a pessimistic (``worst-case'') assumption. When flies are spread further from their population centre, it is more likely that at least one is close to a trap. As such, large populations of flies are less likely to go undetected.

The normal distribution is chosen for a few reasons. Firstly, it is conceptually simple and intuitive to parameterise. This helps with expert elicitation. Secondly, the location has a simple marginal distribution, thanks to the fact that a normally distributed random variable with a normally distributed mean is itself normal.\footnote{This is just the standard conjugacy of the multivariate normal mean for the multivariate normal likelihood when the covariance matrix is fixed.} Thirdly, the distance between a normal random variable and its mean has a known distribution. In particular, if \(X \sim \mathrm{Normal}_2(\pmb \mu, \sigma^2 I_2)\), then \(\lVert X - \pmb \mu \rVert^2 \sim \Gamma(1, \sigma^2/2)\), where \(\Gamma(a, b)\) is the gamma distribution with shape \(a\) and scale \(b\). In this case, or any fly \(i\) we have \(\lVert L_{i,t} - L_c \rVert \mid L_c \sim \Gamma(1, 12.5^2/2)\). Similarly, the \emph{marginal} squared distance between fly \(i\) and the origin is \(\lVert L_{i, t} \rVert^2 \sim \Gamma(1, (12.5^2 + 160^2) / 2)\). Knowing this allows us to easily compare and calibrate the distribution against experimental results. This, in turn, makes elicitation of prior distributions simpler and more intuitive. (It allows us to visualise, for example, the distribution of distances to the origin, as well as to the population centre.)

There is evidence suggesting that Medfly dispersal distance is in fact distributed as a power law (see, e.g., \citet{meats2005} and \citet{plant1991}). In particular, the distributions estimated by these authors have far heavier tails than the distribution proposed above. As mentioned above, the normal prior implies that squared dispersal distances are gamma random variables, the square roots of which are Nakagami distributed. The Nakagami distribution, parameterised as above, has a far thinner right tail than a power law. As such, the present prior distributions may heavily underestimate our best guess about the dispersal distances of individual flies. In further work, we might investigate whether this has a large effect on the results through sensitivity analysis (see section \ref{discussion}).

It may also be worth noting that, in real cases, the assumption of zero mean and spherical covariance matrix (\(\sigma^2 I_2\)) may not be reasonable. Dispersals may have non-zero mean (due to wind direction) and the distance and/or direction of individual dispersals may be correlated.\footnote{These claims are argued for Medfly by \citet{baker1986}.} Further, it may not be reasonable to assume, as I have done here, that the fly population cannot move across time. Ideally, the importance of these assumptions should be checked based on the case at hand (e.g.~properties of the situation or species in question). Extending the model in various ways to meet these problems is beyond the scope of this work, but warrants further investigation.

\hypertarget{likelihood}{%
\subsection{Likelihood}\label{likelihood}}

The likelihood is the distribution of \(y_t \mid \{N_t, \mathbf L_t\}\). This is specified as in the previous chapter. All that we need to specify here is the probability of capture as a function of distance. This function tells us how probable it is that fly \(i\) is captured in trap \(k\) at time \(t\) conditional on \(\lVert L_{i, t} - L_k \rVert\), where, \(L_{i, t}\) is the location of fly \(i\) at time \(t\), and \(L_k\) is the location of trap \(k\). Because the trap locations are fixed and known, the \(N_t \times K\) pair-wise distances between flies and traps are known, conditional on \(\{N_t, \mathbf L_t\}\).

Here, the likelihood is structured as in chapter 3. The only part of the model unspecified there is the probability of capture given distance between fly and trap. I write this as \(p(c \mid d)\), where \(c\) is the event that a fly is captured, and \(d\) is the distance between fly and trap. Since the trap locations are fixed and known (we assume), then, conditional on the locations of flies, \(p(c \mid d)\) tells the probability that the fly is captured in any trap \(k\) as a function of distance \(d = \lVert L_{i} - L_k \rVert\), where \(L_i\) is the location of the fly, and \(L_k\) is the location of the trap.

As mentioned previously, results of trap sensitivity studies are used to inform the likelihood of capture. In particular, I use the results of \citet{meats2005}. These authors estimate that the probability of capture for any given fly in any given trap is given by the power law
\[
p(c \mid d) = \begin{cases}ad^{-b}, & d>1 \\ a & 0 \geq d \geq 1.\end{cases}
\]
Here, \(a = 0.2351055\), \(b = 1.37\), and \(d\) is the distance between the fly and the trap at the start of the period.\footnote{Note that these are transformed from the values reported by the authors. The function is (a) transformed from percentage to proportion scale, (b) halved, as the traps only capture \emph{male} flies, which consist of approximately half of the population, and (c) converted from kilometre to metre scale.} Thresholding is introduced because (a) the function does not yield valid probabilities for small enough \(d\). This function is used for convenience as it is provided by the authors of the study, and data is not publicly accessible. In the context of a more detailed analysis, it may be beneficial to consider uncertainty in the probability of capture by specifying hyperprior distributions for \(a\) and \(b\). I do not explore this further here, as the model is intended to be illustrative only.

Finally, an adjustment is made to \(p(c \mid d)\), before the formulae from the previous chapter are used. In \(p(c \mid d)\) we have the probability of capture over the lifetime of the individual. However, for any given week, we wish to know the probability of reporting capturing a fly over that week. It is assumed that the lifetime is roughly 4 weeks. The correction is reported in detail in the appendix.

\hypertarget{full-statement-of-the-model}{%
\subsection{Full statement of the model}\label{full-statement-of-the-model}}

The model is summarised in the following table.

\[
\renewcommand{\baselinestretch}{1}\normalsize
\begin{aligned}
&\textbf{Population size prior} \\
&\text{Initial no. of flies:} && N_1  \sim \mathrm{Geometric}(1/20) \\
& \text{Number of flies:}~ && N_t \mid N_{t-1}  \sim \mathrm{Poisson}\{ N_{t-1} \exp(R_t) \} \text{, where} \\ & && R_t \sim \mathrm{Normal}(\mu_t, 0.07^2), & t \in \{2, \ldots, T \} \\
\\
&\textbf{Location prior} \\
& \text{Population location:} ~ && L_c \sim \mathrm{Normal_2}(\mathbf 0_2, 160^2 I_2) \\
& \text{Fly locations:}~ && L_{i,t} \mid L_c \sim \mathrm{Normal}_2(L_c, 12.5^2 I_2) & i \in \{1, \ldots, N_t\}, \\
  &&&& t \in \{1, \ldots, T\}\\
\\
&\textbf{Likelihood} \\
& \text{Number of traps:}~ && K \in \mathbb N_+ \\
& \text{Trap locations:}~ && L_k^\text{trap} \in \mathbb R & k \in \{1, \ldots, K\} \\
& \text{Dist. btw. fly } i \text{ and trap } k \text{ at time } t \text{:} && \delta_{i,k,t} := \lVert L_k^\text{trap} - L_{i,t} \rVert & i \in \{1, \ldots, N_t\}, \\
  &&&& k \in \{1, \ldots, K\}, \\
  &&&& t \in \{1, \ldots, T\}\\
& \text{Prob. fly } i \text{ captured in trap }k \text{ at } t: && p(c \mid \delta_{i,k,t}) = \begin{cases}0.235 \cdot \delta_{i,k,t}^{-1.37}, & \delta_{i,k,t} > 1 \\ 0.235 & \delta_{i,k,t} \in [0,1],\end{cases} & i \in \{1, \ldots, N_t\}, \\
  &&&& k \in \{1, \ldots, K\}, \\
  &&&& t \in \{1, \ldots, T\}\\
& \text{Individ. cap. prob.:} && p_{i, t} = 1 - \prod_{k=1}^K (1 - p(c \mid \delta_{i,k,t})), & i \in \{1, \ldots, N_t\}, \\
  &&&& t \in \{1, \ldots, T\} \\
& \text{Aggregate cap. prob.:} && p_t = 1 - \prod_{i=1}^{N_t} (1 - p_{i,t}) & t \in \{1, \ldots, T\} \\
&\text{Detection:}~ && y_t \mid \{ \mathbf L_t, N_t \} \sim \operatorname{Bernoulli}(p_t), & t \in \{1, \ldots, T\} \\
  &&& \mathbf y := [y_t]_{t=1}^T \\ \\
&\textbf{Posterior distribution of interest} \\
&\text{Population size given no detection:} && N_t \mid \mathbf y = \mathbf 0_t & t \in \{1, \ldots, T\}
\end{aligned}
\renewcommand{\baselinestretch}{1}\normalsize
\]

\hypertarget{sampling}{%
\section{Sampling}\label{sampling}}

Inference is performed by sampling from the posterior distribution. Recall that the goal of the model is to (a) evaluate, and (b) propose, zero-catch criteria for Medfly. These are minimum lengths of time over which no flies are detected, before which we can infer and declare eradication. With respect to (a), the key quantity of interest is \(\Pr(N_t = 0 \mid \mathbf y = \mathbf 0_t)\), where \(t\) is the existing zero-catch criteria. In plain English, this is the probability that flies are eradicated, given that they haven't been detected after \(t\) weeks of monitoring. With respect to (b), the key quantity of interest is the smallest \(t\) such that \(\Pr(N_t = 0 \mid \mathbf y = \mathbf 0_t) > 1 - \alpha\), where \(\alpha \in [0, 1]\) represents the decision-maker's degree of risk tolerance.

As such, we need a sampling algorithm that can give us draws of \(N_t \mid \mathbf y = \mathbf 0_t\), for any cutoff \(t\). Note that this is distinct from the distribution of \(N_t \mid \mathbf y = \mathbf 0_T\), where \(t<T\). At time \(t\), we do not know that we will not get another detection up to time \(T\). Rather, we only know that we have not detected any flies yet \textbf{up to now} (i.e.~time \(t\)). Therefore, conditioning on the event \(\mathbf y = \mathbf 0_T\) means that we condition on information not yet available to us. Note, however, that the event where \(\mathbf y = \mathbf 0 _T\) is a \textbf{subset} of the event where \(\mathbf y = \mathbf 0_t\). Observing no detections to time \(T\) logically implies that we did not observe any detections to time \(t\) (assuming \(t < T\)). But the converse is false.

There is a key difficulty with sampling with such methods for this case. This model is \emph{agent-based}, insofar as the individual properties of a random number of individuals (agents) are explicitly represented. In this case, at any time \(t\), there is a location \(L_{i,t}\) for each of \(N_t\) flies. Since \(N_t\) is itself unknown, this means that the number of parameters (namely the number of \(L_{i, t}\) terms) is unknown.\footnote{This is a situation in which ``the number of things you do not know is one of the things you do not know'' (\citet{richardson1997bayesian}).} As mentioned in chapter 2, this introduces a difficulty, as standard Markov chain Monte Carlo techniques, such as basic Metropolis-Hastings, fail when this is the case.

To get around this problem, I have used a simple extension of the basic ABC rejection sampler (see chapter 2). This sampler gives exact, independent, pseudorandom draws from the distribution of \(N_t \mid \mathbf y = \mathbf 0_t\), for any \(t \in \mathbb N_+\). This sampler is intuitive, simple to implement, and relatively efficient for this problem (for the case discussed here, roughly 25\% of samples are \emph{not} rejected). However, other methods exist that may be worth exploring, for analogous problems where the rejection rate of ABC is higher.\footnote{The best known ``trans-dimensional'' Markov sampler is the reversible jump MCMC of \citet{green1995}, generalised by \citet{keith2004}.}

\hypertarget{sketch-of-the-algorithm}{%
\subsection{Sketch of the algorithm}\label{sketch-of-the-algorithm}}

Here I present an algorithm for drawing \emph{at least} \(S\) independent samples from the distribution of \(N_t \mid \mathbf y = \mathbf 0_t\), for all \(t\) up to some arbitrary cutoff \(T\). Note that this quantity is distinct from \(N_t \mid \mathbf y = \mathbf 0_T\). At time \(t\), we do not know that we will not get another detection up to time \(T\). We only know that we have not detected any flies yet \textbf{up to now} (i.e.~time \(t\)).

\begin{itemize}
\tightlist
\item
  Set a number of time periods (i.e.~weeks) \(T\) that is arbitrarily large, so that it covers all time points of interest.
\item
  For each sample \(j\):

  \begin{itemize}
  \tightlist
  \item
    Draw the number of flies and their locations for all time points from their prior distributions.
  \item
    Draw an indicator variable determining whether a fly is captured for each time point \(\mathbf y = \{y_t\}_{t=1}^T\).
  \item
    Store the first (smallest) \(t\) such that \(y_t = 1\). Call this quantity \(\tau_j\). If \(\mathbf y = \mathbf 0_T\), set \(\tau_j = \infty\).
  \end{itemize}
\item
  Stop when the number of samples with \(\tau_j = \infty\) is \(S\).
\end{itemize}

For any number of weeks \(t\), we then extract the subset of draws such that \(\tau_j > t\). This subset is a set of independent posterior draws from \(N_t \mid \mathbf y = \mathbf 0_t\). Depending on how often we observe \(\tau_j = \infty\), we may end up with a much larger number of samples than \(S\). But we end up with exactly \(S\) samples such that \(\tau_j > \infty\), and therefore \(S\) draws of \(N_T \mid \{y_t\}_{t=1}^T = \mathbf 0_T\), where \(T\) is the final time point we consider.

Why does this algorithm work? It may help to consider the simple ABC rejection sampler for \(N_T \mid \mathbf y = \mathbf 0_T\), for some \(T \in \mathbb N_+\). This algorithm works by (1) drawing \(\Theta = \{N_i, \mathbf L_t\}_{t=1}^T\) from the joint prior distribution; then (2) drawing a vector \(\mathbf y = [y_t]_{t=1}^T\) conditional on \(\Theta\); then (3) rejecting the sample if \(\mathbf y \neq \mathbf 0_T\), and keeping it if \(\mathbf y = \mathbf 0_T\). Here, we are getting independent draws from \(p(\Theta \mid \mathbf y = \mathbf 0_T)\) by taking draws from \(p(\Theta, \mathbf y)\), and extracting the subset of draws for which \(\mathbf y = \mathbf 0_T\).

Now note that \(y = \mathbf 0_t\) if and only if the first detection of a fly occurs after time \(t\). In other words, these are the same event. Denote \(\tau\) as the time of the first detection. Then, the event that the first detection is after \(t\) is \(\{\tau > t\}\). It follows trivially that
\[
\Pr(N_t = n \mid \mathbf y = \mathbf 0_t) = \Pr(N_t = n \mid \mathbf \tau > t).
\]
The algorithm proposed above gives us draws from \(N_t \mid \tau > T\), for any \(t \in \mathbf N_+\). By extension, it gives us draws from the posterior \(\mathbf N_t \mid \mathbf y = \mathbf 0_t\).

\hypertarget{sampling-results}{%
\subsection{Sampling results}\label{sampling-results}}

Here, the number of time points chosen was \(T=36\) weeks. This was chosen to include the first week such that the posterior probability of eradication was greater than 0.95 (namely \(t = 35\)). This was discovered through trial and error. At least \(10{,}000\) samples were taken for each \$t \in \{1, \ldots, 36\}, with exactly \(10{,}000\) samples for the case where \(t = 36\). The acceptance rate for sampling was approximately 0.25. This is a relatively high level of acceptance, most likely due to the low likelihood of captures, across most of the high prior density region of the model space.

\hypertarget{results}{%
\section{Results}\label{results}}

Results are shown in \ref{fig:postfig}. this is a plot describing how the probability of eradication changes over time, starting from November 1, the beginning of the monitoring period. The blue line shows the \textbf{prior} probability of eradication by date. This line is strictly increasing, because eradication is an absorbing state for the population. I.e., once the population is eradicated, it can never come back.\footnote{Note, however, that this does not mean that populations are getting smaller on average. The populations that survive} This follows from the assumption of multiplicative growth. The blue line moves up quickly at the beginning, presumably because populations die out more often when they are still small. It moves up again at the end (i.e.~to the right of the plot) because the mean growth rate becomes negative in autumn and winter (see figure \ref{fig:ksplot}). The red line shows the \textbf{posterior} probability of eradication by date. At each week \(t\), the red line shows the probability that the population is eradicated, conditional on no detections up to time \(t\) (i.e., \(\Pr(N_t = 0 \mid \mathbf y = \mathbf 0_t)\)). As we continually fail to detect any flies, our confidence that the flies are eradicated increases, and the red line diverges upward and away from the blue line.

Under the model, the posterior probability of extinction after \(T=12\) weeks is approximately 0.443.\footnote{Unfortunately, it is not straightforward to visualise the prior or posterior density of this quantity.} The first week for which the posterior probability of eradication is greater than 95\% is after 35 weeks, much later than the PFA date.

\begin{figure}

{\centering \includegraphics[width=1\linewidth]{results/pfa_criteria_evaluation/prior_vs_post_plot} 

}

\caption{Prior vs. posterior probability of eradication over 36 weeks.}\label{fig:postfig}
\end{figure}

This model is far more cautious than the zero-catch criteria rule of thumb. On one hand, the model recommends that, if the regulator wants the posterior probability of eradication at the time of PFA status reinstatement to be greater than 95\%, they should wait 35 weeks. This is almost three times longer than the existing ``rule of thumb'' recommendation of 12 weeks. On the other hand, under this model, the posterior probability that flies are eradicated after 12 weeks is less than half.

The results of this model, to the extent that they can be trusted, are highly significant. Suppose we were to infer eradication too early, when a sustainable population still exists. Then, there is a significant chance that the fly population still exists, and will become established. Such a population may stay at undetectable levels for a long period of time, while it spreads and establishes.

\hypertarget{discussion}{%
\section{Discussion}\label{discussion}}

The results above are striking. It is concerning that the model's predictions are so far out of step with the status quo. However, there are varied and significant reasons to doubt the veracity of the results. In this section, I discuss some of these reasons. In particular, I discuss four potential flaws of the model. These are (1) pessimism about trap sensitivity; (2) pessimism about the growth rates of fly populations; (3) neglect of alternative sources of information about pest presence/absence; and (4) arbitrariness of the prior distributions for important parameters. In the course of the discussion, I propose model validation techniques that could subject the model to scrutiny, thereby helping us to understand the significance of these potential flaws. However, due to constraints of time and scope, I do not perform model validation checks here.

Model validation is difficult for this problem. One of the most useful forms of validation for Bayesian models is the comparison of predictions with unseen data. However, in this case, the parameter of interest is population size. This is never observable in real outbreaks, as it is not possible to obtain censuses of flies. As such, for the most part, available model validation techniques are restricted to analysis of the sensitivity of results to the specification of the model's prior distributions and likelihood.

\hypertarget{pessimism-about-trap-sensitivity}{%
\subsection{Pessimism about trap sensitivity}\label{pessimism-about-trap-sensitivity}}

The first potential flaw is pessimism about trap sensitivity. There is a significant body of release-recapture literature for Medfly (see \citet{andress2013} for a thorough review). This literature spans across continents, between the USA, Australia, and Europe. However, for this case study, I have referenced only \citet{ms2007}. This is because it is the only study for Medfly that has been performed in Australia. However, and importantly, the estimated sensitivity of traps seems to be generally much lower than we typically see in other studies. It is not clear whether this is due to (a) some feature of the methodology or materials used, such as low quality sterilised flies; or (b) the efficacy of traps used in Australia. Insofar as the answer is (a) rather than (b), the model may heavily underestimate the sensitivity of traps. When traps are insensitive, the probability of capture decreases. As such, the amount of information carried by a failure to capture (detect) flies also decreases. This will cause the posterior probability of eradication to be lower than it would otherwise. Without further studies, we may wish to perform a meta-analysis across studies to derive a more plausible prior distribution of capture probabilities.

\hypertarget{pessimism-about-growth-rates}{%
\subsection{Pessimism about growth rates}\label{pessimism-about-growth-rates}}

We may also view our model of Medfly growth as excessively pessimistic. Recall that our model of growth is based on modelling results from \citet{ks2019}. As figure \ref{fig:ksplot} shows, the growth rate is estimated to be fairly close to zero at typical temperatures. This means that, under the prior distribution, Medfly populations tend to grow or decay relatively slowly. As a consequence, the model implicitly gives a high prior probability to cases where a Medfly population is small but stable (undetectable). When the population is small but stable, it is far more likely that it will persist undetected for many generations. Fortunately, the growth rate is its own ``module'' in this model, and as such can be subjected to independent scrutiny. In real cases, significant attention should be paid to the plausibility of the growth model. In particular, for the case of Medfly, we might consider the use of black-box simulation models of Medfly population processes, such as the MED-FOES model of \citet{manoukis2014}. Fortunately, the sampling algorithm used above is sufficiently general so that exact posterior inference can be performed for almost any model of growth.

\hypertarget{neglect-of-alternative-sources-of-information}{%
\subsection{Neglect of alternative sources of information}\label{neglect-of-alternative-sources-of-information}}

An important latent assumption of the model under discussion is that there exists only one mechanism for detecting flies. Here, we have assumed that the only way that flies can be detected is by the use of ``set and forget'' monitoring traps. However, when fruit fly outbreaks occur, coordinated efforts are made to inspect fruit for fly larvae (\citet{pirsa}). Further, members of the public are educated in fruit fly detection (Ibid.). As such, there are several pathways through which an incipient population of flies may be discovered. Presumably, the zero-catch criteria are designed assuming that no flies are detected through \emph{any} pathway. The fact that flies have not been detected by larval searches or other means should help to confirm the hypothesis that flies have been eradicated. As such, neglecting this information may lead to an excessively cautious posterior probability of eradication.

How might we test whether this causes a serious issue? Information about differences in detection rates between trapping systems and other pathways is not publicly available. To check the effect of incorporating negative larval searches into the model, we might perform sensitivity analysis. In particular, we might incorporate a Bernoulli random variable at each time \(t\), indicating whether a fly has been detected by larval search. Then we might compare posterior probabilities of eradication, under a range of plausible sensitivities, and the assumption that flies are not detected by larval search (or otherwise).

\hypertarget{arbitrariness-of-prior-distributions}{%
\subsection{Arbitrariness of prior distributions}\label{arbitrariness-of-prior-distributions}}

The final potential flaw of the model is that some key hyperparameters are specified arbitrarily. In particular, there is arbitrariness in (a) the variance of growth rate \(R_t\); (b) the distribution of dispersals; (c) the distribution of the initial population size \(N_1\). In the case of growth rates, low variance can cause stability in the population. This can mean that fly populations can stay stable at undetectable levels for long periods of time. In the case of distributions, a low mean dispersal distance means that flies are less likely to spread out from the population centre. Therefore, it is less likely that at least one fly is close to a trap. Finally, in the case of the initial population size, large populations will grow more quickly in additive terms. As such, they are more likely to be detected. If the initial population size is unreasonably small under the prior, the posterior will be excessively cautious.

In principle, it should be possible to learn the distributions of the growth rates and dispersals from data. This would be advisable for serious approaches to this problem in practice. On the other hand, it is unlikely that the distribution of the population size \(N_1\) can be calibrated empirically. Sensitivity analysis might be performed by checking the results under a range of plausible prior distributions on \(N_1\). This would determine whether the model is sensitive to changes in our prior beliefs about the size of the initial population. I do not perform such an analysis here, as the present model is primarily illustrative, and this is beyond the scope of the work.

\hypertarget{conclusion-2}{%
\section{Conclusion}\label{conclusion-2}}

In this chapter, I explored a simulated scenario involving an outbreak of a particularly salient species of tephritid fruit fly, the Medfly. This served as a ``toy'' case to illustrate use of the model. However, the model is relatively plausible as a depiction of the scenario in question, which is relatively generic in nature. As such, the results may have significant impact on policy. In particular, I found that the posterior probability of eradication is low at the zero-catch criteria date. This gives us reason to doubt that the zero-catch criteria are sufficiently long to ensure a high degree of certainty about eradication.

\hypertarget{conclusion-3}{%
\chapter{Conclusion}\label{conclusion-3}}

There are two main contributions of the present work. The first is a novel method for quantitatively studying zero-trap criteria for fruit fly outbreaks. This method is primarily composed of a Bayesian model of fly populations, which jointly models the population size, locations and monitoring process of an incipient population of an invasive fly species. Though simple, and limited in important ways, the model is intuitive, and has parameters which are easily interpreted. The second contribution is an in-depth application of the model to a hypothetical outbreak of Medfly. The case study illustrates use of the method for evaluating zero-catch criteria.

The results of the case study in chapter 4 have strong policy implications for regulatory decision making in Medfly biosecurity. In this hypothetical scenario, the model finds that the probability of eradication is less than 50\% at the time of pest reinstatement, under the existing rule-of-thumb eradication declaration date. Further, the time to 95\% probability of eradication is nearly three times later than the rule-of-thumb date. If these results are correct, then using the rule-of-thumb may lead the regulator to mistakenly declare eradication, thus allowing an incipient Medfly to become established at small but stable levels.

\hypertarget{appendices}{%
\chapter{Appendices}\label{appendices}}

\hypertarget{appendix-1-population-location-prior}{%
\section{Appendix 1: Population location prior}\label{appendix-1-population-location-prior}}

A trick is used to derive a prior for the case presented in chapter 4. The idea here is that we want to use the information in the fact that a fly was detected at the centre of the trap. The trick is to model the probability of the first detection being at trap \(k\) as the probability that a fly is detected at \(k\) in a given period conditional on exactly one fly total being detected in that period. A benefit of this model is that it does not depend on how many weeks it took to get the first detection (which would require information about how long flies have been around before the first detection).

Suppose we have \(K\) traps indexed by \(k \in \{1, \ldots, L\}\). Suppose also that we have a prior distribution over the population size \(N\), given by \(N \sim \mathrm{Geometric} (0.05)\), as in chapter 4. (Here we assume no change in population size over time.) Now, we suppose that each trap \(k\) is ``competing'' to catch the first fly each week. Suppose, for simplicity, that all flies are located at a single random point \(L\). Under the prior distribution, we assume that \(L\) is distributed uniformly over a \(3.2 \times 3.2 ~ \mathrm{km}^2\) trapping grid, with traps spaced evenly at 400 m intervals. Finally, define the random variable
\[
C_k = \begin{cases}1 & \text{a fly is caught in trap } k \text{ before any other trap} \\ 0 & \text{otherwise}. \end{cases}
\]

Note that, in chapter 4, letting \(\delta\) denote the centre trap, we observe \(C_\delta=1\), and \(C_k = 0, ~ \forall k \neq \delta\). Under these assumptions, the posterior \(L \mid C_k = 1\) is the distribution of \(L\), given that a fly was caught in trap \(k\) before any other trap. The idea of this method is to infer this posterior distribution, and set it to be our prior distribution for the population location in the main model.

For the example in chapter 4, Gibbs sampling was used to infer the posterior distribution. Under the above assumptions, the distribution of the posterior \(L \mid C_\delta = 1\) resembles a bivariate normal distribution with mean \(\mathbf 0_2\) and variance \(160^2 I_2\).

\hypertarget{appendix-2-distance-between-a-bivariate-normal-random-variable-and-its-mean-is-gamma-distributed}{%
\section{Appendix 2: Distance between a bivariate normal random variable and its mean is gamma distributed}\label{appendix-2-distance-between-a-bivariate-normal-random-variable-and-its-mean-is-gamma-distributed}}

Here I prove a claim made in chapter 4. This is the claim that \(X \sim \mathrm {Normal}_2 (\pmb \mu, \sigma^2 I_2) \implies \lVert X - \pmb \mu \rVert^2 \sim \Gamma(1, \sigma^2/2)\), where \(\Gamma(a, b)\) is the gamma distribution with shape \(a\) and scale \(b\).

Let \(X \sim \mathrm {Normal}_2 (\pmb \mu, \sigma^2 I_2)\) so that \(X_i \sim \mathrm{Normal}(\mu_i, \sigma^2)\), \(i \in \{1, 2\}\). Also, let \(Z_i \sim \mathrm{Normal}(0, 1), ~ i \in \{1, 2\}\). Then,

\[
\begin{aligned}
  Y &= \lVert X - \pmb \mu \rVert^2  \\
    &= (X_1 - \mu_1)^2 + (X_2 - \mu_2)^2 \\
    &= \sigma^2 (Z_1^2 + Z_2^2). \\
\end{aligned}
\]
Therefore, \(Y \sim \sigma^2 \chi^2(2)\), by the well known theorem that the sum of \(n\) independent standard normal random variables is distributed as \(\chi^2(n)\). This distribution is equivalent to \(\Gamma(1, 1/2)\), where \(\Gamma\) is defined as above. By the scaling property of the gamma distribution, we have \(Y \sim \Gamma(1, \sigma^2 / 2)\).

\hypertarget{appendix-3-probability-of-capture-time-adjustment}{%
\section{Appendix 3: Probability of capture time adjustment}\label{appendix-3-probability-of-capture-time-adjustment}}

In chapter 4, I explain that we use estimates of the probability of capture over the lifetime of an individual fly. If these were used without correction for weekly capture probabilities, we would overestimate the probability of capturing any given fly. Here, I explain a correction used to adjust the probabilities of capture, when we are interested in the probability of capture over only one week.

Suppose there is just one fly. Let \(q\) be the probability that the fly is captured over its lifetime (4 weeks). Assume that each week, the fly is captured with daily capture probability \(p\). We have
\[
\begin{aligned}
  q &= \Pr(\text{fly caught in lifetime}) \\
    &= \Pr(\text{fly caught on week 1, 2, 3, or 4}) \\
    &= 1 - \Pr(\text{fly not caught on week 1, 2, 3, or 4}) \\
    &= 1 - (1 - p)^{4} \\
    \implies p &= 1 - (1-q)^{1/4}.
\end{aligned}
\]
Therefore, the probability that the fly is caught in any given week is \(1 - (1 - q)^{1/4}\), where \(q\) is the lifetime probability of capture.

In chapter 4, it is assumed that Medfly lifetimes are four weeks long. Note, however, that we could substitute any proportion for \(1/4\). Further, one could define the proportion as a random variable with a prior distribution, if we wish to model uncertainty about fly lifetime lengths.

% Trigger ToC creation in LaTeX
\renewcommand{\baselinestretch}{1}\normalsize

  \bibliography{book.bib,packages.bib}

\end{document}
