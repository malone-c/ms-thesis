% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
\PassOptionsToPackage{dvipsnames,svgnames*,x11names*}{xcolor}
%
\documentclass[
]{book}
\usepackage{amsmath,amssymb}
\usepackage{lmodern}
\usepackage{setspace}
\usepackage{ifxetex,ifluatex}
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\hypersetup{
  pdftitle={Bayesian inference of eradication of incipient Tephritid fruit fly populations, with application to Mediterranean fruit fly},
  pdfauthor={Chris Malone},
  colorlinks=true,
  linkcolor=Maroon,
  filecolor=Maroon,
  citecolor=Blue,
  urlcolor=blue,
  pdfcreator={LaTeX via pandoc}}
\urlstyle{same} % disable monospaced font for URLs
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{longtable,booktabs,array}
\usepackage{calc} % for calculating minipage widths
% Correct order of tables after \paragraph or \subparagraph
\usepackage{etoolbox}
\makeatletter
\patchcmd\longtable{\par}{\if@noskipsec\mbox{}\fi\par}{}{}
\makeatother
% Allow footnotes in longtable head/foot
\IfFileExists{footnotehyper.sty}{\usepackage{footnotehyper}}{\usepackage{footnote}}
\makesavenoteenv{longtable}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{5}
\usepackage{booktabs}
\usepackage{setspace}
\usepackage{amsmath}
\usepackage[algo2e,linesnumbered,ruled]{algorithm2e}
\usepackage{algorithm}
\ifluatex
  \usepackage{selnolig}  % disable illegal ligatures
\fi
\usepackage[]{natbib}
\bibliographystyle{plainnat}

\title{Bayesian inference of eradication of incipient Tephritid fruit fly populations, with application to Mediterranean fruit fly}
\author{Chris Malone}
\date{2022-05-09}

\begin{document}
\maketitle

\setstretch{1}
% Trigger ToC creation in LaTeX
\renewcommand{\baselinestretch}{1}\normalsize
\tableofcontents
\renewcommand{\baselinestretch}{2}\normalsize

\hypertarget{introduction}{%
\chapter{Introduction}\label{introduction}}

\hypertarget{control-and-monitoring-of-tephritid-fruit-flies}{%
\section{Control and monitoring of Tephritid fruit flies}\label{control-and-monitoring-of-tephritid-fruit-flies}}

TODO: Restructure the following paragraphs; focus more on zero-catch criteria

Biological invasions are incursions of incipient populations of plants or animals that are non-native to a given region. In the midst of the ongoing globalisation of trade, the salience of biological invasions is increasing around the world. Biological invasions are salient because they pose severe economic and environmental risks. On the economic side, they threaten ``wholesale loss of agricultural, forestry, and fishery resources'' (\citet{mack2000}). On the environmental side, they threaten to disrupt native ecological processes -- outcompeting potentially endangered natives, and creating globally homogenous, ``cosmopolitan'' ecological systems.

Tephritid fruit flies (\emph{Diptera Tephritidae}) are of particularly high economic significance. Species in this genus have the potential to destroy a wide variety of horticultural produce, in extremely large amounts. Females lay eggs in plant tissue (often fruits). Eggs develop into larvae, which then feed on the plant tissue. Potential costs of Tephritid fruit fly incursions include losses to significant crop losses; materials and labour allocated to their eradication or suppression; knock-on effects to agricultural produce as a consequence of pesticide usage (\citet{suckling2016}). Economic costs of successful fruit fly invasions in Australia have been estimated to be as high as hundreds of millions of dollars (\citet{suckling2016}, \citet{hancock2000}).

Governments have a responsibility monitor and eradicate potential biological invasions. In particular, the Australian government is legally bound by the Biosecurity act 2015 to ensure a very low level of risk for animal and plant invasions. A core element required for controlling this risk is the development of capacities for monitoring and controlling pest outbreaks. Monitoring biological species is difficult and costly. As such,in the public interest, the cost of increasing monitoring intensity must be traded off against the cost of failing to detect an incipient invasion.

The manager's role is made more difficult when a pest population is \emph{sub-detectable}. Populations may be subdetectable because they can persist at low rates; because they are \emph{taxonomically cryptic} (i.e.~hard to distinguish from well known native species); because they are \emph{behaviourally cryptic} (i.e.~behave in ways that help them avoid detection by predators; see \citet{kery2002}); or because the population is suppressed by efforts to eradicate them. Matters are made worse when tests to detect the presence of a population have extremely low sensitivity for other reasons. For example, monitoring traps for fruit flies have very low attractiveness. One study of Mediterannean fruit fly found that only 0.02\% of 38.8 million flies were recaptured after release, in a standard surveillance setup in Adelaide (\citet{ms2007}).

Suppose an outbreak of an invasive pest has occurred. Monitoring for the pest must then be intensified and localised to the area of suspicion. If the pest has since been eradicated, governments are incentivised to declare eradication quickly. This is because suspension of pest free area status is economically costly to local producers. On the other hand, if eradication has \emph{not} occured, declaring eradication prematurely could (a) lower the manager's credibility, and therefore value of local produce, and (b) cause larger costs longer term due to local establishment of the pest.

A necessary prerequisite for minimising the probability of failing to detect an existing invasion is to understand what can be inferred about the state of the population from what has been observed in surveillance. In particular, it is desirable to understand the likelihood that extinction has occurred, given that the species has not been detected over a certain period of time.

PFA status is economically valuable to producers in the relevant region. Firstly, there may be offshore markets which require that produce is supplied from a PFA for a given pest. Secondly, in some markets, PFA status may allow the supplier to receive a price premium for goods sold. In other words, PFA status increases the value of local produce on international markets.

TODO: Discuss ZTC.

\hypertarget{problems-this-work-seeks-to-address}{%
\subsection{Problems this work seeks to address}\label{problems-this-work-seeks-to-address}}

As mentioned above, the manager seeks to minimise resources spent on surveillance, while minimising the chance that an eradication is declared when none has occurred. The general problem this thesis is concerned with is to infer whether or not an invasive species has been extinguished based on survey records.

The present work attempts to address two gaps related to Tephritid fruit flies. First of all, I attempt to develop a model for understanding the evidential properties of survey records in arbitrary trapping grids. Second of all, I attempt to address the issue of evaluating existing PFA reinstatement dates. These are the date- and location-dependent lengths of time for which a pest must not be observed before eradication can be declared.

I seek to develop a method that can (a) evaluate proposed zero-catch criteria from a statistical point of view; (b) help to formulate new zero-catch criteria based on thresholds for the posterior probability of eradication; and (c) flexibly inform decision making, so that decision makers can weigh the cost of eradication probabilistically against the cost of further eradication attempts.

TODO: Write a paragraph about how the primary goal of the model is to infer the eradication of \textbf{spot infestations} -- i.e.~small, incipient infestations.

\hypertarget{outline-of-this-work}{%
\subsection{Outline of this work}\label{outline-of-this-work}}

TODO: Write outline of the whole thesis

\hypertarget{lit-review}{%
\chapter{Literature review}\label{lit-review}}

TODO: Write introduction to this chapter

\hypertarget{zero-catch-criteria}{%
\section{Zero-catch criteria}\label{zero-catch-criteria}}

TODO: Explain the role of zero-catch criteria in fruit fly trapping. Cite Meats and Clift as evidence of this being the case.

``eradication of spot pest infestations, such as Medfly, is common to regions normally claiming area freedom (fruit fly exclusion zones)'' (Meats 2005, p.~1335).

\begin{itemize}
\tightlist
\item
  Zero-catch scenarios.
\item
  Rules of thumb.
\end{itemize}

\hypertarget{elaborate-models}{%
\section{Elaborate models}\label{elaborate-models}}

\hypertarget{elaborate-models-for-inferring-pest-absence}{%
\subsection{Elaborate models for inferring pest absence}\label{elaborate-models-for-inferring-pest-absence}}

The problem of inferring the presence or absence of a difficult-to-detect species has a literature of its own. Models date back to at least the 1990s, using relatively simple and general models to infer pest absence (see \citet{todocite}). Such simple methods are attractive for their simplicity, generality, and efficiency of computation. Unfortunately, these models make strong assumptions about priors which are not defensible in general. For example, most assume a fixed, and either constant or declining population size (\citet{caley2015}, p.~2). This is not reasonable for the study of invasive species, whose numbers are uncertain, and may be increasing quickly. Many models assume that we can estimate a sighting rate, which is constant as a function of the locations of the individuals.

Another issue with simpler models is their relative inflexibility with respect to the structure of the model. For example, many models (see, e.g., \citet{mcardle}, \citet{barnes}, \citet{boakes}) assume that we know the probability of detecting a specimen drawn randomly from the population. However, in the case of fruit flies, this quantity is difficult to study empirically. This is because the capture probability is highly dependent on the spatial layout and types of monitoring traps. In turn, the layout and type of trap are highly dependent on time and place in which the monitoring is taking place. For example, countries (and states within countries) differ in the types of traps used and the spatial density of traps. As such, while we may be able to learn about the probability of capture \textbf{per trap}, it is not possible to learn about the probability that a fly is captured in general.

In contrast, a class of elaborate models for inferring species extinction have recently emerged. In particular, two attempts have recently been made to develop biologically realistic models to infer probability of eradication from the survey record. These papers provide inspiration for the model I develop in the following chapter -- although there are also some marked differences, as the reader will see. Here, I will discuss the contributions of each of these papers.

\hypertarget{red-fire-ants}{%
\subsection{Red fire ants}\label{red-fire-ants}}

The first instance of an elaborate Bayesian model for inferring pest eradication is given by \citet{keith2013}. The authors use an agent-based Bayesian model to infer the distribution of fire ant nests in Brisbane. They obtained data on the locations and month of discovery for \(n = 7{,}068\) nests. They also observed whether data were passively or actively discovered (e.g.~by members of the public or through a targeted search).

The model explicitly models the location of each agent (ant nest). Typically, when a Bayesian model is agent based, this means that there is an unknown number of parameters in the model. The upshot of this is that typical Markov Chain Monte Carlo (MCMC) methods, such as the Metropolis Hastings sampler, fail. This is because they do not allow the dimension of the parameter vector to vary between draws. To get around this problem, a generalised Gibbs sampling algorithm is used. This gets around the problem by adding a step to the Gibbs sampler in which we move between coordinate spaces.

\hypertarget{red-foxes}{%
\subsection{Red foxes}\label{red-foxes}}

The second instance of an elaborate Bayesian model for inferring eradication is given by \citet{caley2015}. Caley and co-authors develop a Bayesian model of fox sightings in Tasmania. Their goal is to infer the posterior probability that foxes had been eradicated, given a record of fox carcass sightings. They obtained data on fox carcass sightings from two sources, namely hunter kills and road kills. These separate ``observation processes'' were modelled separately, so that posterior detection rates were allowed to differ between the sighting types. Detection rates were assumed to be constant across time and location for each type of sighting. Notably, uninformative priors were set for detection rates (i.e.~the probability of detecting a fox was set to be uniform on \([0, 1]\)). This was because the fox sighting mechanism has not been studied empirically (indeed, it is not clear how it could be studied at all). Data consisted of a single sighting count for each location (with Tasmania divided geographically into grid cells) and each year between 2001 and 2013. Data were all zeroes with the exception of exactly four unit observations (sightings of exactly one fox).

The authors use a form of approximate Bayesian computation (ABC) to sample from the posterior. ABC works by first drawing samples of the parameter vector \(\theta\) from the prior distribution \(\pi(\theta)\), then second, drawing simulated data \(y_{\text{sim}}\) from the likelihood, then keeping the proposed \(\theta\) if and only if \(y_{\text{sim}}\) is an approximate match with the observed data. The authors use the sum of the observations over the observation period as the matching statistic. They kept samples only if the \(y\) simultations were an exact match with the data.

\hypertarget{gaps}{%
\section{Gaps}\label{gaps}}

Above, I have discussed the two elaborate computational models in the literature for inferring eradication of an incipient biological invasion. The current work seeks to address two gaps in the literature.

Firstly, elaborate Bayesian models have not been explored for inferring eradication of Tephritid fruit flies. Fruit flies pose an interesting case study, because the regulator has fine grained information about the detection system. In particular, the regulator knows the locations of each of the traps. Further, prior research investigating the efficacy of these traps exists. If used carefully, this information can be leveraged through the model's priors to learn from the zero-sighting record efficiently. Leveraging such information would represent the first attempt to use prior literature to set informative priors.

Fruit flies are interesting for a few reasons:

\begin{itemize}
\tightlist
\item
  A body of research exists to understand trap efficacy.
\item
  The surveillance program is predictably structured.
\item
  The intensity of the surveillance program changes in a predictable way.
\end{itemize}

No model has been developed for the case where prior information exists on the probability of detecting a specimen as a function of distance between the detection site and the specimen.

\hypertarget{fruit-fly-literature-gaps}{%
\subsection{Fruit fly literature gaps}\label{fruit-fly-literature-gaps}}

Complex models have not been developed to study the problem of inferring fruit fly eradication from. Such models, if developed, could perform a range of useful functions. For example, when used with zero-catch data, such models could be used (a) to evaluate rules of thumb for PFA reinstatement; (b) to rigorously devise new recommendations for PFA reinstatement, that are sensitive to specific features of the outbreak; and (c) to provide the decision maker with precise probabilistic estimates of the probability of eradication given any particular length of time for which flies were not detected. Further, such models, when used with real surveillance datasets, could also be used to learn about crucial properties of fruit fly species, such as their field population growth rates, and trap capture rates.

TODO: Note that this work builds on the work of \citet{lg1994}. The authors examine the likelihood of zero detections for various population sizes. This work expands that work by exploring the use of prior distributions on the location and population size. This allows for the use of prior information, and modelling of intensified surveillance (e.g.~generalising to scenarios with variable spatial densities of traps).

\hypertarget{conclusion}{%
\section{Conclusion}\label{conclusion}}

TODO: Write conclusion of this chapter

\hypertarget{model-development}{%
\chapter{Model development}\label{model-development}}

TODO: Write introduction to this chapter
TODO: Write outline of this chapter

\hypertarget{the-scenario}{%
\subsection{The scenario}\label{the-scenario}}

TODO: Write a general description of the zero catch scenario

In the following, I describe a general probabilistic model of an ecological system. The size, location, and number of captures, for a biological population, are explicitly modelled. It is assumed that the data are a number of captures (or, alternatively, sightings or detections), and that we wish to infer posterior distributions for the parameters governing size and/or locations.

\hypertarget{structure-of-the-model}{%
\section{Structure of the model}\label{structure-of-the-model}}

At the most basic level, I propose to define a joint distribution over (a) the number of flies in a population, (b) the location of each fly, and (c) the number of flies that are detected (caught in traps). Defining notation, at each time point \(t\), we must define a joint distribution over the number of flies \(N_t\), the \(N_t \times 2\) matrix of fly locations \(\mathbf L_t\), and the number of flies detected \(y_t\). (It is assumed that the frequency of time points \(t\) is determined by the frequency at which surveillance traps are checked.) I.e., the model is a joint distribution \(p(\{N_t, \mathbf L_t, y_t\}_{t=1}^T)\). Our goal is, primarily, to infer the posterior distribution of the population size at the last time point \(N_T\), conditional on \(\mathbf y = \{y_t\}_{t=1}^T = \mathbf 0_T\). To make this possible, we must specify a joint \textbf{prior} distribution over \(\{N_t, \mathbf L_t\}\), and a likelihood, i.e.~a distribution for \(\mathbf y \mid \{N_t, \mathbf L_t\}_{t=1}^T\). Instead of defining a joint prior directly on \(\mathbf N = \{N_t\}_{t=1}^T\), I define a prior distribution over the parameters that govern the process by which the population grows or decays over time. As such, an assumed stochastic growth model structures the prior over \(\mathbf N\).

It is assumed that traps have fixed, known locations. The probability of capture for each fly, conditional on their location, is then computed as a function of the distance between that fly and each trap.

\hypertarget{why-make-the-model-spatially-explicit}{%
\section{Why make the model spatially explicit?}\label{why-make-the-model-spatially-explicit}}

The value of including a spatial component in the model may be questioned. This is relatively unusual in standard approaches (see, e.g., \citet{mcardle1990}). However, incorporating the spatial component allows us to leverage a useful source of prior information about trap efficacy. There exists a moderately large literature of \textbf{release-recapture} studies for various species of fruit fly (\citet{todocite}). Release recapture studies give us two kinds of data -- one one hand, we get the total proportion of flies recaptured; on the other hand, we also get the mean proportion of flies captured \textbf{per trap}, given distance between that trap and the release point. The first kind of data can be useful when the experimental setting is similar to the real-world setting for which we want to perform inference. This will be approximately the case when the types of traps, their number, and the spacing between them, are the same. However, this will often not be the case. For example, studies vary significantly in the types and number of traps used. Further, we may wish to infer eradication of pest populations in trapping systems that are genuinely novel or untested. For example, after an outbreak has occurred, and eradication measures have been stopped, it is common to set up supplementary trapping units to intensify monitoring and increase the likelihood of detecting flies, conditional on their presence in the area (\citet{supp_traps}).

\hypertarget{population-size}{%
\subsection{Population size}\label{population-size}}

As mentioned above, a prior distribution must be set for the population size \(N_t\) at each time point \(t \in \{1, \ldots, T\}\). A natural way to do this is to define a model of the population's change. Explicitly, I recommend to define a prior over \(N_1\) directly. Then, define a prior on \(N_t\) the previous values of \(N\), as well as parameters governing the growth. A simple example is the Poisson branching process with exponential change. This is a model of the form
\[
N_t \mid \{N_{t-1}, R_t\} \sim \operatorname{Poisson}(N_{t-1} \exp \{R_t\}),
\]
where a continuous prior distribution is defined over the \(R_t\) terms, which may have support over the whole real line.\footnote{Alternatively, the logistic growth model, with an additional ``carrying capacity'' parameter, could be used.} This prior is attractive because the exponential growth model is highly popular in biology. Therefore, it should be relatively simple to set informative prior hyperparameters for the latent variable \(R_t\). This might be through expert elicitation, or review of the relevant literature, in which population change may already be expressed in terms of growth rates.\footnote{For example, see \citet{papadopoulos2002}.}

It may be worth noting that we could choose to factor in covariate information for the growth process. For example, for a given pest species, we might understand the growth of populations over time as a function of weather or rainfall. I do not discuss this possibility further in this thesis. It may also be worth noting that there are no a priori assumptions on the population dynamics for the growth model. Thanks to the generality of the sampling algorithm, it is simple to ``plug in'' elaborate growth models. For example, the models of \citet{lux2018} or \citet{manoukis2014} could be used to generate independent random draws from the population of Medfly. In this way, they can structure our prior over the population size. In this case, inference would proceed simple as in the case I outline here. This highlights key benefits of the modelling approach taken here, namely its flexibility and modularity.

\hypertarget{locations-of-flies}{%
\subsection{Locations of flies}\label{locations-of-flies}}

I first discuss the option of setting a uniform prior. Setting an uninformative prior is fairly straightforward for this problem. In particular, we might assume that, beyond a certain distance from the outbreak centre (say, 1km) any existing population of Medfly is distinct from the population of interest. Therefore, we might set the prior distribution for the population location to be uniform on the surface of a disc with (e.g.) 1km radius around the outbreak centre.

Despite the fact that an uninformative prior is relatively straightforward to set, it is most likely not advisable in specific applications. Firstly, when an outbreak is suspected, it is typical that information about location is available. On one hand, fruit flies are heavily dependent on the availability of suitable fruit trees for survival and reproduction. Therefore, someone with local area knowledge will be able to determine the most likely locations for an existing population. On the other hand, if an outbreak is known or suspected, then flies must have been detected somewhere. Most likely, the locations of these detections will be known to the analyst. When the fly species has low dispersal distances (as e.g.~medfly does) these detection locations are highly informative. Therefore, an informative prior, utilising this information, formally or informally, is recommended.

\hypertarget{fly-locations}{%
\subsection{Fly locations}\label{fly-locations}}

It is assumed the flies are typically clustered in space. This may be justifiable in practice. For a small, seed population, a population with low density will die out due to the allee effect. However, when this assumption is not realistic, an alternative prior on locations should be considered.

Let \(L_c\) be a bivariate random variable describing the centre of the population. Let \(L_{i, t}\) be a bivariate random variable describing the location of fly \(i\) at time \(t\). It seems natural to assume that \(\mathrm E (L_{i, t} \mid L_c) = L_c\), for any \((i, t)\). This model assumes that the centre of the population does not move over time. Further, we can specify that \((L_{i, t} \perp \!\!\! \perp L_{i', t'}) \mid L_c\), for \((i, t) \neq (i', t')\). I.e., conditional on the centre of the population, the fly locations provide no information about each other. This gives the computational advantage that we do not need to track flies locations across time. At each time period, they scatter independently.

The benefit of these assumptions is priors can be set on the parameters governing \(L_c\) and \(L_{i, t} \mid L_c\) separately. The prior on \(L_{i, t}\) describes the distribution of fly dispersals. Information on this quantity, for a given species, will often be available in scientific literature.

\hypertarget{probability-of-capture-likelihood}{%
\subsection{Probability of capture (likelihood)}\label{probability-of-capture-likelihood}}

Recall from above that the number of captures (and therefore the data vector) at time point \(t\) is written as \(y_t\), for \(t \in \{1, \ldots, T\}\). Recall that it is assumed that the trap locations are each fixed and known with certainty. Then, it is assumed that the probability that fly \(i\) is caught in trap \(k\) at time \(t\) is given by \(p_{i, k, t} = p(d_{i, k, t})\) where \(d\) is the distance between fly \(i\) and trap \(k\) at time \(t\), and \(p(\cdot)\) gives us the probability of capture as a function of distance. Then, the probability that a fly is caught at any trap is simply
\[
p_{i, t} := 1 - \prod_{k=1}^K(1 - p(d_{i, k, t})).
\]

The probability of capture function \(p(\cdot)\) is based on prior analysis of release-recapture data, already discussed, and may be deterministic or random. For example, we might regress captures on distance, from release-recapture data, and allow coefficients to vary randomly. Then, the posteriors would form the priors for the present model.

An intuitive distribution for \(y_t\) is the Poisson-binomial distribution. This is the distribution of successes in independent Bernoulli trials with unequal means.

Note that this model of captures takes for granted the common assumption that there is no interference between traps (see \citet{todocite}). This assumption is essentially that the probability that a fly is captured at a given trap is not affected by the presence of other traps. The justification is that \(p(\cdot)\) is typically estimated to decrease quickly as a function of distance. This is because traps are generally ineffective as attractants. Therefore, it is typically the case that \(p(d_{i, k, t})\) is very small for all but at most one trap. Therefore, the effect of discounting the possibility of being caught there is negligible.

NOTE: Delete the next paragraph?

If the researcher has cause to believe that interference may be non-negligible, a simple correction can be applied. Without loss of generality, suppose we are interested in a single fly in a single trapping period. Let \(q_k\) be the probability that that fly is captured at trap \(k\), calculated using the distance function above. Let \(q_0\) be the probability that the fly is not captured at all. The set \(\{q_k\}_{k=0}^K\) are probabilities of exhaustive and mutually exclusive events. Therefore, we can redefine the probabilities of trap-specific capture (or no capture) as \(q'_k = q_k / \sum_{i=0}^K q_i\).

TODO: Write conclusion of this chapter

\hypertarget{case-study-mediterranean-fruit-fly}{%
\chapter{Case study: Mediterranean fruit fly}\label{case-study-mediterranean-fruit-fly}}

TODO: Probabilistic graphical model of the entire model (with a box to demarcate the ``internal'' components from the components on which a prior distribution is set).

\hypertarget{introduction-1}{%
\section{Introduction}\label{introduction-1}}

TODO: Rewrite this intro in light of the model proposal chapter

In the previous chapter, I proposed to address a gap in the literature by providing an elaborate model for inferring the eradication of an incipient invasive population of Tephritid fruit flies. In this chapter, I present an illustrative model of medfly surveillance after an hypothetical invasion. I use a simplified model of Medfly population dynamics. However, for various species of Tephritid fruit fly (medfly included) detailed models exist. A benefit of the proposed method is that it can easily incorporate almost any model of medfly dynamics.\footnote{Note, though, that the sampling method I use may not be appropriate in all cases. When the model predicts that the population size ``explodes'', then the rejection rate for the sampling algorithm may become very high, causing the algorithm to be highly inefficient.}

TODO:

\begin{itemize}
\tightlist
\item
  Note that this analysis is primarily illustrative. Performing a more specific analysis requires access to confidential data.
\item
  Note that the method can be used for a real scenario - we only need to change the priors, data and locations of the traps.
\item
  Note that I use a simplified model of Medfly dynamics for illustrative purposes - but the method can easily incorporate more complex ABS models, and cite those models.
\end{itemize}

TODO: Write one paragraph outlining this chapter

\hypertarget{medfly-ceratitis-capitata}{%
\section{Medfly (Ceratitis capitata)}\label{medfly-ceratitis-capitata}}

\hypertarget{medfly-are-economically-important}{%
\subsection{Medfly are economically important}\label{medfly-are-economically-important}}

Mediterranean fruit fly (\emph{Ceratitis Capitata}) or \emph{medfly} are a particularly salient species of tephritid fruit fly. Medflies have high invasive potential, as it can adapt to a relatively large range of climates and environments, and is known to have the capability to infest the fruits of over 300 species of plants (Ibid.). Recently, an incursion of medfly in Adelaide, South Australia, prompted a large scale eradication effort. This comprised in part of hiring 350 special-purpose staff that set over 13,000 additional traps, and collected over 350 tonnes of fruit. The scale of the response to this outbreak indicates the perceived economic significance of this fruit fly species.

\hypertarget{medfly-are-cryptic}{%
\subsection{Medfly are cryptic}\label{medfly-are-cryptic}}

Medfly are very hard to detect at low levels. Monitoring for medfly is typically performed with the aid of lured traps (namely so-called Lynfield or Jackson traps). These traps are relatively ineffective for detecting medfly. For example, one study from the Adelaide metro area trapping grid found that only 0.02\% of flies were recaptured from a release of 38.8 million flies. Further, medfly are known to have low dispersals across space. This means that low-lying populatons of flies may go undetected across generations. \url{https://onlinelibrary-wiley-com.virtual.anu.edu.au/doi/pdfdirect/10.1111/j.1570-7458.2006.00415.x}

\hypertarget{data}{%
\section{Data}\label{data}}

In a Bayesian model, various sources of data can be used either to perform inference on parameters (i.e.~infer marginal posterior distributions) or to inform prior distributions. For the present model, I propose to to perform inference on simulated data from a hypothetical scenario. However, real data is used to inform the structure of the prior distribution and the likelihood.

\hypertarget{zero-sighting-surveillance-data}{%
\subsection{Zero-sighting surveillance data}\label{zero-sighting-surveillance-data}}

As mentioned above, I do not use real data to estimate parameters. Instead, I model a hypothetical situation. The situation is as follows: We assume that at least one fly has been detected; eradication measures have since begun and then ceased; and we now proceed with intensified monitoring, while whatever population that may exist is free to grow relatively unhindered. The goal of the analysis is to infer the probability of eradication for the incipient population, given that no flies detected at any point in this period. Therefore, our ``data'' is a vector of zeroes, with one for each vector.

Thus, the data we wish to learn from is hypothetical, or simulated. The idea is to simulate a relatively realistic scenario. We observe the outcomes of a surveillance process. The surveillance process is generated by weekly checks of traps that are deployed uniformly in a given area (more about the trapping arrangement below). It is assumed that no specimens are detected at any point in the survey period. In other words, the sum of all detected counts in the period is zero.

\hypertarget{prior-data-on-capture-probability-release-recapture-studies}{%
\subsection{Prior data on capture probability: release recapture studies}\label{prior-data-on-capture-probability-release-recapture-studies}}

In the previous chapter, I briefly discussed release-recapture experiments. These are experiments involving the release of large numbers of flies into networks of standard traps. These studies give us a useful source of information about the probability of capturing a fly given distance between a fly and a trap.

In cases where Bayesian models have been used, data has not been available on detection rates. For example, \citet{caley2014} and \citet{keith2013} set uninformative priors on the detection rates, and attempt to learn the detection rates for data. However, because of their global economic importance, tephritid fruit flies are relatively well studied. In particular, a number of fruit fly species have been studied with release recapture experiments. Release recapture experiments involve the release of a large number of (often sterilised) fruit flies. These studies help us to learn both the dispersal patterns and tendencies of various species of fly, but also the effectiveness of various trap types and layouts.

\hypertarget{model}{%
\section{Model}\label{model}}

Now that I have discussed background and the data available, I turn to a detailed discussion of the model for this case. This discussion builds on the previous chapter, where the general, basic model was outlined. Here, I focus on the specific prior distributions and likelihood that are used.

For exposition, I break the model into the following three components: (1) The size of the population (number of individuals); (2) the locations of individuals and traps; and (3) number of individuals caught in traps, conditional on (1) and (2).

The likelihood of a given number of captures is a function of latent variables, namely the number and locations of flies. Under the prior distribution, it is assumed that data at any given timestep are generated as follows. Firstly, nature draws a number of flies (i.e.~a population size) which may or may not be based on the number of flies at the previous time step. Next, nature draws a location for each of the flies. Finally, nature draws a number of detections.

\hypertarget{population-size-1}{%
\subsection{Population size}\label{population-size-1}}

In this case, \(N_1\) is the first week after the most recent fly detection. I have chosen to give \(N_1\) the prior distribution \(N_1 \mid \lambda \sim \mathrm{Poisson}(\lambda)\), where \(\lambda \sim \mathrm{Exponential}(0.05)\). This distribution for \(N_1\) is chosen as it is a discrete distribution with right skew, and a relatively large amount of mass \(f_{N_1}(x)\) at \(x = 0\), corresponding to the situation where flies are already eradicated (see \citet{prior_init_size})

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{g }\OtherTok{=} \DecValTok{1}\SpecialCharTok{/}\DecValTok{20}
\NormalTok{init\_pmf }\OtherTok{=} \ControlFlowTok{function}\NormalTok{(n, g) g }\SpecialCharTok{/}\NormalTok{ (}\DecValTok{1}\SpecialCharTok{+}\NormalTok{g)}\SpecialCharTok{\^{}}\NormalTok{(n}\SpecialCharTok{+}\DecValTok{1}\NormalTok{)}

\NormalTok{x }\OtherTok{=} \DecValTok{0}\SpecialCharTok{:}\DecValTok{100}

\NormalTok{df }\OtherTok{=} \FunctionTok{data.frame}\NormalTok{(}\AttributeTok{x =}\NormalTok{ x, }\AttributeTok{y =} \FunctionTok{init\_pmf}\NormalTok{(x, g))}

\FunctionTok{ggplot}\NormalTok{(df) }\SpecialCharTok{+}
  \FunctionTok{geom\_bar}\NormalTok{(}\AttributeTok{stat =} \StringTok{\textquotesingle{}identity\textquotesingle{}}\NormalTok{, }\FunctionTok{aes}\NormalTok{(x, y)) }\SpecialCharTok{+}
  \FunctionTok{xlab}\NormalTok{(}\FunctionTok{bquote}\NormalTok{(}\FunctionTok{italic}\NormalTok{(n))) }\SpecialCharTok{+}
  \FunctionTok{ylab}\NormalTok{(}\FunctionTok{bquote}\NormalTok{(}\StringTok{\textquotesingle{}Pr(\textquotesingle{}}\SpecialCharTok{*}\FunctionTok{italic}\NormalTok{(N)[}\DecValTok{1}\NormalTok{] }\SpecialCharTok{==} \FunctionTok{italic}\NormalTok{(n)}\SpecialCharTok{*}\StringTok{\textquotesingle{})\textquotesingle{}}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{figure}
\centering
\includegraphics{_main_files/figure-latex/prior_init_size-1.pdf}
\caption{(\#fig:prior\_init\_size)Prior distribution of initial population size}
\end{figure}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Prior probability that they\textquotesingle{}re already eradicated}
\end{Highlighting}
\end{Shaded}

As for the population sizes at later time points, I assume that growth is exponential at an uncertain rate. In particular, it is assumed that, for \(t \in \{2, \ldots, T\}\), \(N_t \mid N_{t-1}, R_t \sim \mathrm{Poisson}(N_{t-1} e^{R_t})\). Here, we can give any continuous distribution for \(R_t\). I have chosen the vaguely informative prior \(R_t \stackrel{\text{iid}} \sim \mathrm N(0, 0.2)\). The symmetry of this prior means that we are indifferent about whether the population is growing or declining.

The growth rate prior has been chosen to place the vast majority of density below their estimated growth rate under optimal conditions. Medfly have been estimated to grow at 8\% per day, in optimal lab conditions (\citet{papadopoulos2002}). Under an exponential growth model this is 56\% per week. This can be taken as an extremely \emph{pessimistic} upper bound on the growth rate. In real cases, flies may fail to establish due to food scarcity, predation, and/or unsustainably low population density.

In real cases, it will be desirable to attempt to estimate \(R_t\) from data. In particular, it is known that fruit fly population growth rates are highly dependent on temperature. Therefore, it would be wise to estimate and draw values of \(R_t\) conditional on weather measurements. Choosing an empirically realistic distribution for \(R_t\) is likely to improve the efficiency of inference from the survey record.

\hypertarget{spatial-location}{%
\subsection{Spatial location}\label{spatial-location}}

As mentioned in the previous chapter, the model is spatial, insofar as likelihood of detection depends on distances between traps and individual flies.

TODO: Explain that the centre of the grid is the site of the last detection.

\hypertarget{population-location}{%
\subsubsection{Population location}\label{population-location}}

The centre of of the population is assumed to be located at the two dimensional vector \(L_c\). I have set the prior on \(L_c\) to be
\[
L_c \sim \mathrm {Normal}_2 (\mathbf 0_2, 160^2 I_2),
\]
where \(\mathrm{Normal}_2\) is the bivariate normal distribution, \(\mathbb 0_2\) is the two-dimensional zero vector and \(I_2\) is the \(2 \times 2\) identity matrix. This prior reflects a prior belief that the centre of the population is highly likely to be found somewhere on a disc with. E.g., we believe that there is a 95\% chance that the centre of the population is within \(1.96 \cdot 160 \approx 320\) metres of the centre of the grid.\footnote{For details about how this prior was arrived at, see appendix.} Recall that this makes sense because we believe that the flies are within the distribution.

\hypertarget{individual-fly-dispersals}{%
\subsubsection{Individual fly dispersals}\label{individual-fly-dispersals}}

Let \(L_{i, t}\) denote the location of fly \(i\) at time \(t\), as in the previous chapter. I assign this quantity the prior distribution
\[
L_{i, t} \mid L_c \sim \mathrm {Normal}_2 (L_c, 12.5^2 I_2)
\]
where the notation is defined as in the previous section above. The variance of this distribution is chosen on the basis of prior analysis of dispersal data (see appendix).

Note: Do I need to prove the claims in the next paragraph?

The normal distribution is chosen for a few reasons. Firstly, it is conceptually simple and intuitive to parameterise. Secondly, the location has a simple marginal distribution, thanks to the fact that a normal random variable with a normal mean is itself normal. Thirdly, the distance between a normal random variable and its mean has a known distribution. In particular, for any fly \(i\), the squared distance between \(L_{i,t}\) and \(L_c\), conditional on \(L_c\), has the gamma distribution with parameters \(\alpha = 1\), and \(\beta = 12.5^2 / 2\). Similarly, the distance between \(L_{i, t}\) and the origin is the same but with \(\beta = (12.5^2 + 160^2) / 2\). Knowing this allows us to easily compare and calibrate the distribution against experimental results. This, in turn, makes elicitation of priors simpler and more intuitive. (It allows us to visualise, for example, the distribution of distances to the origin and to the population centre.)

It may be worth noting that, in real cases, the assumed prior distribution on dispersals may not be reasonable. For example, dispersals may have non-zero mean (due to strength and direction) or non-spherical covariance matrix (i.e.~non-equal variances and/or non-zero covariances).\footnote{This is argued by \citet{baker1986}.} Further, it may not be reasonable to assume that the fly population cannot move across time. Ideally, the importance of these assumptions should be checked based on the case at hand (e.g.~properties of the situation or species in question). Extending the model in various ways to meet these problems is beyond the scope of this work, but warrants further investigation.

\hypertarget{trap-locations}{%
\subsection{Trap locations}\label{trap-locations}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{grid\_size }\OtherTok{=} \DecValTok{4}
\NormalTok{general\_grid\_1d }\OtherTok{=} \FunctionTok{seq}\NormalTok{(}\SpecialCharTok{{-}}\NormalTok{grid\_size }\SpecialCharTok{/} \DecValTok{2}\NormalTok{, grid\_size }\SpecialCharTok{/} \DecValTok{2}\NormalTok{) }\SpecialCharTok{*} \DecValTok{400}
\NormalTok{general\_grid }\OtherTok{=} \FunctionTok{expand.grid}\NormalTok{(general\_grid\_1d, general\_grid\_1d)}
\NormalTok{general\_traps }\OtherTok{=} \FunctionTok{as.matrix}\NormalTok{(general\_grid)}

\NormalTok{d }\OtherTok{=} \DecValTok{200} \SpecialCharTok{/} \FunctionTok{sqrt}\NormalTok{(}\DecValTok{2}\NormalTok{)}
\NormalTok{supp\_grid\_1d }\OtherTok{=} \FunctionTok{seq}\NormalTok{(}\SpecialCharTok{{-}}\NormalTok{d, d, }\AttributeTok{length.out =} \DecValTok{4}\NormalTok{)}
\NormalTok{supp\_traps }\OtherTok{=} \FunctionTok{expand.grid}\NormalTok{(supp\_grid\_1d, supp\_grid\_1d)}
\NormalTok{all\_traps }\OtherTok{=} \FunctionTok{rbind}\NormalTok{(general\_traps, supp\_traps)}

\NormalTok{supp\_indicator }\OtherTok{=} \FunctionTok{rep}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\StringTok{\textquotesingle{}General\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}Supplementary\textquotesingle{}}\NormalTok{), }\FunctionTok{c}\NormalTok{(}\FunctionTok{nrow}\NormalTok{(general\_traps), }\FunctionTok{nrow}\NormalTok{(supp\_traps)))}
\NormalTok{traps\_df }\OtherTok{=} \FunctionTok{data.frame}\NormalTok{(all\_traps, }\FunctionTok{factor}\NormalTok{(supp\_indicator, }\FunctionTok{c}\NormalTok{(}\StringTok{\textquotesingle{}Yes\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}No\textquotesingle{}}\NormalTok{)))}

\CommentTok{\# Plot of traps}
\FunctionTok{ggplot}\NormalTok{(traps\_df) }\SpecialCharTok{+}
  \FunctionTok{geom\_circle}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x0=}\DecValTok{0}\NormalTok{, }\AttributeTok{y0=}\DecValTok{0}\NormalTok{, }\AttributeTok{r=}\DecValTok{200}\NormalTok{), }\AttributeTok{colour =} \StringTok{\textquotesingle{}grey\textquotesingle{}}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\FunctionTok{aes}\NormalTok{(Var1, Var2, }\AttributeTok{col=}\NormalTok{supp\_indicator)) }\SpecialCharTok{+}
  \FunctionTok{coord\_fixed}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{xlab}\NormalTok{(}\StringTok{\textquotesingle{}X coordinate (metres)\textquotesingle{}}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{ylab}\NormalTok{(}\StringTok{\textquotesingle{}Y coordinate (metres)\textquotesingle{}}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{col =} \StringTok{\textquotesingle{}Trap type\textquotesingle{}}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{scale\_x\_continuous}\NormalTok{(}\AttributeTok{breaks =}\NormalTok{ (}\SpecialCharTok{{-}}\DecValTok{4}\SpecialCharTok{:}\DecValTok{4}\NormalTok{)}\SpecialCharTok{*}\DecValTok{200}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{scale\_y\_continuous}\NormalTok{(}\AttributeTok{breaks =}\NormalTok{ (}\SpecialCharTok{{-}}\DecValTok{4}\SpecialCharTok{:}\DecValTok{4}\NormalTok{)}\SpecialCharTok{*}\DecValTok{200}\NormalTok{) }
\end{Highlighting}
\end{Shaded}

\begin{figure}
\centering
\includegraphics{_main_files/figure-latex/trap_grid-1.pdf}
\caption{(\#fig:trap\_grid)Illustration of the hypothetical trapping grid. Grey circle represents 200m radius disc surrounding the site of the most most recently detected medfly specimen.}
\end{figure}

As mentioned previously, it is assumed that trap locations have fixed, known locations. In particular, we assume that monitoring is intensified for the first 6 weeks (\(t \in \{1, \ldots, 6\}\)). By intensified monitoring, I mean that \textbf{supplementary} monitoring traps have been placed alongside the previously existing grid of \textbf{general} monitoring traps. More precisely, it is assumed that \textbf{general} surveillance traps are placed year round in a 400 \(\times\) 400 metre grid (DPIPWE, 2011, p.~50). The \textbf{supplementary} surveillance system consists of a set of 16 traps in a circular area, centred at the site of the first fly detection.\footnote{It is typical to wait until at least 2 flies have been detected near each other for an outbreak to be declared. To illustrate the method in a simplified setting, I suppose that one fly detection is sufficient.} See \citet{trap_grid}.

\hypertarget{probability-of-capture}{%
\subsubsection{Probability of capture}\label{probability-of-capture}}

I assume that the probability of capture for any given fly in any given trap is
\[
p(x) = \begin{cases}ax^{-b}, & d>1 \\ a & 0 \geq d \geq 1\end{cases}
\]
where \(a = 0.4702111\), \(b = 1.37\), and \(x\) is the distance between the fly and the trap at the start of the period. Thresholding is introduced because (a) the function does not yield valid probabilities for small enough \(x\). In general, the use of a negative exponential function is not ideal here. This function is used for convenience as it is provided by the authors of the study, and data is not publicly accessible. In the context of a more detailed analysis, it may be beneficial to approximate this function with a more ``well behaved'' function. This is not within the scope of this thesis.

TODO: mention that the probability of capture is adjusted, because the study gives us the lifetime probability of capture.

The results of release recapture studies are highly variable, and gaining access to data may be difficult for older studies. In this case, it may be desirable to incorporate uncertainty about the probability function. This could be done, for example, by assigning prior distributions to the coefficients \(a\) and \(b\). I do not explore this any further here, as this model exposition is intended for the purposes of illustration only.

\hypertarget{computing-the-posterior-distribution}{%
\section{Computing the posterior distribution}\label{computing-the-posterior-distribution}}

In this section, I discuss the problem of computing the posterior distribution, given a survey record. Above, I stated that the model could be defined flexibly. Without restrictions on the form of the growth and detection models, the posterior may be analytically intractable. In other words, we will not be able to write out the posterior density or mass as a function of the data and prior distributions. Such situations are common in the Bayesian framework, because of the tendency for the posterior density or mass to depend, implicitly or explicitly, on analytically intractable integrals.

So far, we have talked about situations when sampling is required for inference. Further problems arise when the model is \emph{agent-based}. In other words, when we include uncertainty about individual-level features in the model. In this case, the detection probability is random, even when the location and population size is known. In other words, the probability of detecting at least one individual is a function of the number of individuals, and also their individual (random) properties. This is a situation in which ``the number of things you do not know is one of the things you do not know'' (Richardson and Green, 1997).

\hypertarget{abc-models}{%
\subsection{ABC models}\label{abc-models}}

A simple rejection algorithm is used to draw samples from the posterior distribution (see previous chapter). Instead of matching on a statistic, such as the sum of the observations, the rejection rule was set so that data were only kept in cases where the simulated data vector was an exact match with the actual data (the hypothetical zero-catch record).

Here, I have used ABC for intuitiveness, ease of implementation, and the fact that it is relatively efficient for this problem. However, other methods exist that may be worth exploring, for analogous problems where the rejection rate of ABC is higher. There are at least two known methods for sampling from the posterior when the dimension of the parameter space is uncertain. These are the reversible jump MCMC sample (\citet{green1995}) and the generalised Gibbs sampler (\citet{keith2015}). These may be worth exploring for problems where the rejection rate is high for EBC.

Interestingly, the standard justifications for and against ABC do not apply to the case under consideration. Firstly, the standard justification for ABC is that it allows for inference when the likelihood function is ``intractable'' - i.e., unknown, uncomputable or otherwise difficult to work with. However, for the current model, the likelihood is known, and relatively simple to write out.

On the other hand, the standard drawback for ABC is that it ensures that we can typically only draw from the posterior approximately. Under standard conditions, we must define a criteria for similarity between simulated and observed data. This is typically done by specifying a summary statistic \(S(\mathbb y)\), and a similarity measure \(\rho(S(\mathbb y), S(\mathbb y'))\) defined over the space spanning our data \(\mathbb y\). We reject a sample if we observe \(\rho(\mathbb y_{\text{observed}}, \mathbb y_{\text{simulated}} ) > \epsilon_0\), where \(\epsilon_0\).

\(10{,}000\) samples were taken. The acceptance rate for sampling was 0.68. This high level of acceptance is due to the low likelihood of captures, across most of the high prior density region of the model space. The acceptance rate can be interpreted as a numerical approximation to the prior probability of observing zero captures.

\hypertarget{results}{%
\section{Results}\label{results}}

\begin{itemize}
\tightlist
\item
  The fly free period is 12 weeks or 28 days and one generation, whichever is longer (\citet{meats2005}). In summer, a Medfly generation takes 28-34 days (\citet{dpirdwa}). Therefore, the period I look at is over 12 weeks. However, this may be different based on the period that the manager is interested in.
\end{itemize}

The posterior probability of extinction after 12 weeks is approximately 0.684.\footnote{Unfortunately, it is not straightforward to visualise the prior or posterior density of this quantity.}

\hypertarget{discussion}{%
\section{Discussion}\label{discussion}}

Here I discuss limitations and objections.

\hypertarget{drawbacks}{%
\subsection{Drawbacks}\label{drawbacks}}

\begin{itemize}
\tightlist
\item
  We do not get a posterior distribution over the probability of eradication.
\end{itemize}

TODO: Section on objections to/limitations of the model

\begin{itemize}
\tightlist
\item
  Objection: the model is subjective
\item
  Objection: The model is too sensitive to priors.

  \begin{itemize}
  \tightlist
  \item
    Defence in Caley 2015
  \end{itemize}
\end{itemize}

\hypertarget{future-work}{%
\subsection{Future work}\label{future-work}}

\begin{itemize}
\tightlist
\item
  Sensitivity analysis for \(N_1\)
\item
  Sensitivity analysis for growth rates
\item
  Model checking for the growth process
\item
  Estimating growth process parameters from data.
\end{itemize}

TODO: Write conclusion of this chapter

% Trigger ToC creation in LaTeX
\renewcommand{\baselinestretch}{1}\normalsize

\hypertarget{appendices}{%
\chapter{Appendices}\label{appendices}}

TODO: Add appendix on location prior

\hypertarget{appendix-1-proof-of-abc-procedure}{%
\section{Appendix 1: Proof of ABC procedure}\label{appendix-1-proof-of-abc-procedure}}

Here, I give a proof that the simple ABC rejection algorithm yields independent draws from the posterior distribution. Recall that the algorithm works by drawing samples of \(\theta\) from the prior distribution with density \(\pi (\theta)\). Then, for each draw of \(\theta\), we draw a data vector \(y_{\text {sim}}\) from the likelihood \(l(\theta \mid y_{\text{sim}})\). Finally, we keep the sample if we observe that \(y_{\text{sim}} = y_{\text{obs}}\) (where \(y_{\text{obs}}\) is the data vector we actually observed) and reject it otherwise. Then, the draws that we keep have distribution \(f_{\text{ABC}}(\theta) = \pi(\theta) \cdot l(\theta \mid y_{\text{obs}})\), since our draws from the prior and likelihood are independent.\footnote{Credit is due to \href{https://stats.stackexchange.com/questions/380076/proof-of-approximate-exact-bayesian-computation.}{this StackExchange post}.}

\hypertarget{appendix-2-full-model-statement}{%
\section{Appendix 2: Full model statement}\label{appendix-2-full-model-statement}}

\[
\renewcommand{\baselinestretch}{1}\normalsize
\begin{aligned}
&\textbf{Population size} \\
&\text{Initial no. of flies:} && N_1 \mid \lambda \sim \mathrm{Pois}(\lambda) \text{, where} \\
&&& \lambda \sim \mathrm{Exponential}(0.05) \\
& \text{Number of flies:}~ && N_t \mid N_{t-1}  \sim \mathrm{Poisson}\{ N_{t-1} \exp(R) \} \text{, where} \\ & &&R \sim \mathrm{Normal}(0, 12.5^2), & t \in \{2, \ldots, T \} \\
\\
&\textbf{Fly locations} \\
& \text{Population location:} ~ && L \sim \mathrm{Normal_2}(\mathbf 0_2, 160^2 I_2) \\
& \text{Fly locations:}~ && L_{i,t}^\text{fly} \mid L \sim L + \mathrm{Normal}_2(\mathbf 0_2, 30^2 I_2) & i \in \{1, \ldots, N_t\}, \\
  &&&& t \in \{1, \ldots, T\}\\
\\
&\textbf{Detection model} \\
& \text{Number of traps:}~ && K \in \mathbb N_+ \\
& \text{Trap locations:}~ && L_k^\text{trap} \in \mathbb R & k \in \{1, \ldots, K\} \\
& \text{Dist. btw. fly } i \text{ and trap } k \text{ at time } t \text{:} && \delta_{i,k,t} := \lVert L_k^\text{trap} - L_{i,t}^\text{fly} \rVert & i \in \{1, \ldots, N_t\}, \\
  &&&& k \in \{1, \ldots, K\}, \\
  &&&& t \in \{1, \ldots, T\}\\
& \text{Individ. cap. prob.:} && p_{i, t} = 1 - \prod_{k=1}^K (1 - p(\delta_{i,k,t})), & i \in \{1, \ldots, N_t\}, \\
  &&&& t \in \{1, \ldots, T\}\\
&  && \mathbf p_t := [p_{i,t}]_{i=1}^{N_t}  & t \in \{1, \ldots, T\} \\
&\text{No. of captures:}~ && y_t \mid \theta \sim \text{Poisson-binomial}(N_t, \mathbf p_t), & t \in \{1, \ldots, T\} \\
  &&& \mathbf y := [y_t]_{t=1}^T
\end{aligned}
\renewcommand{\baselinestretch}{1}\normalsize
\]

\hypertarget{appendix-3-population-location-prior}{%
\section{Appendix 3: Population location prior}\label{appendix-3-population-location-prior}}

To update on detection location when the first fly is detected at a trap (say trap k) we can use a trick. The trick is to model the probability of the first detection being at trap k as the probability that a fly is detected at k in one period conditional on exactly one fly total being detected in that period. The benefit of this model is that it does not depend on how many weeks it took to get the first detection (which would require information about how long flies have been around before the first detection). See appendix for more details.

A mathematical trick can be used to derive a prior in some cases. Suppose we have \(K\) traps indexed by \(k \in \{1, \ldots, L\}\). Suppose also that we have a prior distribution over the population size \(N\), given by \(N \sim \mathrm{Poisson} (\lambda)\), with \(\lambda \sim \mathrm{Exponential(1/20)}\). Here we assume no change in population size over time. Now, we suppose that each trap \(k\) is ``competing'' to catch the first trap each week. We suppose that the trap at the centre of the grid was the first to catch a fly, and we want to use this information. Define the random variable
\[
C_k = \begin{cases}1 & \text{a fly is caught in trap } k \text{ before any other trap} \\ 0 & \text{otherwise}. \end{cases}
\]

Under these assumptions, \(L \mid C_k = 1\) is the distribution of \(L\), given that a fly was caught in trap \(k\) before any other trap.

Whether or not we can analytically derive the posterior density depends on the probability of capture function \(p(x)\). In the case we consider here, the function cannot be integrated, and so I resort to sampling. Under the above assumptions, the posterior resembles the convolution of a normal and a uniform distribution (see figure). See appendix for more details.

  \bibliography{book.bib,packages.bib}

\end{document}
